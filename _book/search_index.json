[
["index.html", "Introdução ao R com aplicações em biodiversidade e conservação Capítulo 1 Pré-requisitos", " Introdução ao R com aplicações em biodiversidade e conservação 2020-09-11 Capítulo 1 Pré-requisitos "],
["introdução-à-análises-multidimensionais.html", "Capítulo 2 Introdução à Análises Multidimensionais 2.1 Backgorund da análise 2.2 Exemplo 1: 2.3 Exemplo 2:", " Capítulo 2 Introdução à Análises Multidimensionais Neste módulo iremos aprender como implementar no R as análises multivariadas mais comumente utilizadas em ecologia de comunidades. Para isso precisaremos dos pacotes vegan,labdsv e ade4. Procuraremos explicar brevemente a lógica por trás de cada teste, a sua aplicação em problemas comumente encontrados em estudos ecológicos, mas não destrinchar detalhadamente como cada método funciona e o seu componente matemático. Em geral, análises multivariadas têm três principais utilidades: reduzir a dimensionalidade dos dados e encontrar a principal direção de variação dos dados, testar relações entre matrizes, ou ainda encontrar diferenças entre grupos. Apesar dessas análises também serem utilizadas como análises exploratórias e para descrever padrões em estudos ecológicos, a necessidade de se ter hipóteses, ou ao menos expectativas a priori, não pode ser ignorada. Se quiser saber mais sobre aspectos teóricos e filosóficos das análises, sugerimos consultar James &amp; McCulloch (1990). Antes de entrar de cabeça nas análises multivariadas também, sugerimos fortemente o estudo de métodos de amostragem e como fazer boas perguntas. Não vamos nos extender muito nesses tópicos porque eles foram abordados nas aulas disponíveis no YouTube. Análises multivariadas podem ser divididas, grosseiramente, em dois tipos: agrupamento e ordenação. Análises de agrupamento em geral tentam agrupar objetos (observações) em grupos de maneira que objetos do mesmo grupo sejam mais semelhantes entre si do que objetos de outros grupos. Mais formalmente, o agrupamento de objetos (ou descritores) é uma operação pela qual um conjunto de objetos (ou descritores) é particionado em dois ou mais subconjuntos, usando regras pré-estabelecidas de aglomeração ou divisão (Legendre &amp; Legendre, 2012). Por outro lado, a análise de ordenação é uma operação pela qual os objetos (ou descritores) são posicionados num espaço que contém menos dimensões que o conjunto de dados original; a posição dos objetos ou descritores em relação aos outros também podem ser usadas para agrupá-los. Vamos começar com análises de agrupamento. Aqui vamos exemplificar dois métodos: uma técnica de agrupamento hierarquica (dendrograma) e outra não-hierarquica (k-means. 2.1 Backgorund da análise O objetivo da análise de agrupamento é agrupar objetos admitindo que haja um grau de similaridade entre eles. Esta análise pode ser utilizada ainda para classificar uma população em grupos homogêneos de acordo com uma característica de interesse. A grosso modo, uma análise de agrupamento tenta resumir uma grande quantidade de dados e apresentála de maneira fácil de visualizar e entender (em geral, na forma de um dendrograma). No entanto, os resultados da análise podem não refletir necessariamente toda a informação originalmente contida na matriz de dados. Para avaliar o quão bem uma análise de agrupamento representa os dados originais existe uma métrica — o coeficiente de correlação cofenético — o qual discutiremos em detalhes mais adiante. Antes de considerar algum método de agrupamento, pense porque você esperaria que houvesse uma descontinuidade nos dados; ou ainda, considere se existe algum ganho prático em dividir uma nuvem de objetos contínuos em grupos. O padrão apresentado pelo dendograma depende do protocolo utilizado (método de agrupamento e índice de dissimilaridade); os grupos formados dependem do nível de corte escolhido. O leitor interessado é remetido à duas referências: Legendre &amp; Legendre (2012) e Borcard et al. (2018). 2.2 Exemplo 1: Pergunta: Existem grupos de espécies de anfíbios anuros com padrões de ocorrência similar ao longo de poças? Predições 1: Iremos encontrar ao menos dois grupos de espécies: aquelas que ocorrem em poças dentro de floresta vs. aquelas que ocorrem em poças de áreas abertas. Variáveis Variáveis preditoras A nossa matriz de dados contém a abundância das espécies nas linhas e locais (poças) nas colunas. 2.2.1 Explicação da análise A matriz deve conter os objetos a serem agrupados (e.g., espécies) nas linhas e as variáveis (e.g., locais de coleta ou medidas morfológicas) nas colunas. A escolha do método de agrupamento é crítico para a escolha de um coeficiente de associação. É importante compreender as propriedades dos métodos de agrupamento para interpretar corretamente a estrutura ecológica que eles evidenciam (Legendre &amp; Legendre, 2012). De acordo com a classificação de Sneath &amp; Sokal (1973) existem cinco tipos de métodos: 1) seqüenciais ou simultâneos; 2) aglomerativo ou divisivo ;3) monotéticos ou politéticos; 4) hierárquico ou não hierárquicos e 5) probabilístico. Métodos hierárquicos podem ser divididos naqueles que consideram o centróide ou amédia aritmética entre os grupos. O principal método hierárquico que utiliza a média aritmética é o UPGMA (Agrupamento pelas médias aritméticas não ponderadas), e o principal método que utiliza centróides é a Distância mínima de Ward. O UPGMA funciona da seguinte forma: a maior similaridade (ou menor distância) identifica os próximos agrupamentos a serem formados. Após esse evento, o método calcula a média aritmética das similaridades ou distâncias entre um objeto e cada um dos membros do grupo ou, no caso de um grupo previamente formado, entre todos os membros dos dois grupos. Todos os objetos recebem pesos iguais no cálculo. O método de Ward é baseado no critério de quadrados mínimos (OLS), o mesmo utilizado para ajustar um modelo linear. O objetivo é definir os grupos de maneira que a soma de quadrados (i.e. similar ao erro quadrado da ANOVA) dentro dos grupos seja minimizada (Borcard et al. 2018). Checklist Verifique se não há espaço nos nomes das colunas e linhas Se os dados forem de abundância, recomenda-se realizar a transformação de Hellinger (Legendre &amp; Gallagher, 2001). Se a matriz original contiver muitos valores discrepantes (e.g., uma espécie muito mais ou muito menos abundante que outras) é necessário transformar os dados usando log1p. Se as variáveis forem medidas tomadas em diferentes escalas (metros, graus celcius etc), é necessário padronizar cada variável para ter a média 0 e desvio padrão 1. Isso pode ser feito utulizando a função decostand do pacote vegan. 2.2.2 Análise Para começar, vamos primeiro importar os dados e depois calcular a matriz de distância que seja adequada para o tipo de dado que temos (abundância de espécies - dados de contagem) library(ecodados) # Carrega o arquivo multivar_bocaina library(vegan) #sp_compos &lt;- read.table(&quot;bocaina.txt&quot;, h=TRUE) sp_compos &lt;- multivar_bocaina head(sp_compos) ## BP4 PP4 PP3 AP1 AP2 PP1 PP2 BP9 PT1 PT2 PT3 BP2 PT5 ## Aper 0 3 0 0 2 0 0 0 0 0 0 181 0 ## Bahe 859 14 14 0 87 312 624 641 0 0 0 14 0 ## Rict 1772 1517 207 573 796 0 0 0 0 0 0 0 0 ## Cleuco 0 0 0 0 0 0 0 0 0 29 369 0 84 ## Dmic 0 0 6 60 4 0 0 0 2758 319 25 0 329 ## Dmin 0 84 344 1045 90 0 0 0 8 0 0 0 0 bocaina &lt;- t(sp_compos)#transpondo a matriz para obter a classificação por linhas distBocaina &lt;- vegdist(bocaina, method=&quot;horn&quot;)#produz uma matriz de similaridade com o coeficiente de Morisita-Horn dendro &lt;- hclust(distBocaina, method=&quot;average&quot;)#produz um agrupamento com a função hclust e o método UPGMA Visualizar os resultados plot(dendro) 2.2.2.1 Interpretação dos resultados Antes de começarmos a interpretar os resultados precisamos verificar que o agrupamento reduziu a dimensionalidade da matiz de forma eficiente, de maneira a não distorcer a informação. Fazemos isso calculando o Coeficiente de correlação cofenética (CCC) cofresult &lt;- cophenetic(dendro) cor(cofresult, distBocaina) ## [1] 0.8819701 Um CCC &gt; .7 indica uma boa representação. Portanto, o nosso resultado de 0.8819701 é bastante alto, garantindo que o dendrograma é adequado. No entanto, para interpretar os resultados precisamos antes definir um nível de corte, que vai nos dizer quantos grupos existem. Há vários métodos para definir grupos, desde os heurísticos aos que utilizam bootstrap. Se quisermos interpretar este dendrograma, podemos por exemplo estabelecer um nível de corte de 50% de distância (ou seja, grupos cujos objetos tenham ao menos 50% de similaridade entre si). plot(dendro) k = 4 n = nrow(bocaina) MidPoint = (dendro$height[n-k] + dendro$height[n-k+1]) / 2 abline(h = MidPoint, lty=2) Nesse caso teremos a formação de cinco grupos, representados pelos nós que estão abaixo da linha de corte. 2.3 Exemplo 2: A seguir, vamos utilizar o pacote pvclust que calcula automaticamente o nível de corte de similaridade baseado no Bootstrap de cada nó. Uma desvantagem deste método é que ele somente aceita índices de similaridade da função dist que possui apenas a distância Euclidiana, Manhattan e Canberra. Uma maneira de contornarmos essa limitação é utilizar transformações dos dados disponíveis na função disttransform no pacote BiodiversityR ou o decostand do pacote vegan. Também é possível utilizar a transformação de Box-Cox para dados multivariados, disponível no material suplementar de Legendre &amp; Borcard (2018) aqui library(pvclust) library(BiodiversityR) Aqui vamos utilizar a distância de Chord para calcular a matriz de distância. Se transformarmos uma matriz usando a transformação Chord e depois calcularmos a distância Euclidiana, isso equivale à calcular diretamente a distância de Chord: bocaina_transf &lt;- disttransform(bocaina, &quot;chord&quot;) analise &lt;- pvclust(bocaina_transf, method.hclust=&quot;average&quot;, method.dist=&quot;euclidean&quot;) ## Bootstrap (r = 0.46)... Done. ## Bootstrap (r = 0.54)... Done. ## Bootstrap (r = 0.69)... Done. ## Bootstrap (r = 0.77)... Done. ## Bootstrap (r = 0.85)... Done. ## Bootstrap (r = 1.0)... Done. ## Bootstrap (r = 1.08)... Done. ## Bootstrap (r = 1.15)... Done. ## Bootstrap (r = 1.23)... Done. ## Bootstrap (r = 1.38)... Done. plot(analise, hang=-1) pvrect(analise) É possível notar que existe um único grupo com BS &gt; 95%. Agora vamos tentar usar a distância de Hellinger: bocaina_transf2 &lt;- disttransform(bocaina, &quot;hellinger&quot;) analise2 &lt;- pvclust(bocaina_transf2, method.hclust=&quot;average&quot;, method.dist=&quot;euclidean&quot;) ## Bootstrap (r = 0.46)... Done. ## Bootstrap (r = 0.54)... Done. ## Bootstrap (r = 0.69)... Done. ## Bootstrap (r = 0.77)... Done. ## Bootstrap (r = 0.85)... Done. ## Bootstrap (r = 1.0)... Done. ## Bootstrap (r = 1.08)... Done. ## Bootstrap (r = 1.15)... Done. ## Bootstrap (r = 1.23)... Done. ## Bootstrap (r = 1.38)... Done. plot(analise2, hang=-1) pvrect(analise2) Notem que se mudarmos o coeficiente de associação, o resultado também muda. Agora temos 1 grupo a mais, composto por Dendropsophus minutus e Scinax duartei que não apareciam antes. Isso se deve ao fato de que a distância de Hellinger dá menos peso para espécies raras do que a Chord. "],
["k-means-e-agrupamentos-não-hierarquicos.html", "Capítulo 3 K-means e agrupamentos não-hierarquicos 3.1 Backgorund da análise 3.2 Exemplo 1: 3.3 Backgorund da análise 3.4 Exemplo 1:", " Capítulo 3 K-means e agrupamentos não-hierarquicos 3.1 Backgorund da análise K-means é um tipo de agrupamento não hierarquico porque não busca obter grupos menores que por sua vez pertencem a grupos maiores. Resumidamente, podemos calcular o K-means apartir de uma matriz quadrada ou de distância. Essa técnica procura particionar os objetos em k grupos de maneira a minimizar a soma de quadrados entre grupos e maximizá-la dentro dos grupos. Um critério similar ao de uma ANOVA. 3.2 Exemplo 1: Pergunta: Qual é o número de grupos que melhor sumariza o padrão de ocorrência de espécies de peixes ao longo de um riacho? Predições 1: O agrupamento ideal para explicar a variância no padrão de ocorrência de espécies é 4. Variáveis Variáveis resposta Para este exemplo iremos utilizar um conjunto de dados disponível no pacote ade4 que contém dados de 27 espécies de peixes coletados em 30 pontos ao longo do Rio Doubs, na fronteira entre a França e Suiça. 3.2.1 Explicação da análise Um diferencial do K-means em relação aos agrupamentos hierarquicos (=clusters) é que o usuário pode escolher antecipadamente o número de grupos que quer formar. Checklist Vamos normalizar os dados de abundância antes de entrar na análise propriamente, já que existem muitos zeros na matriz. 3.2.2 Análise library(ade4) data(doubs) head(doubs$fish) ## Cogo Satr Phph Neba Thth Teso Chna Chto Lele Lece Baba Spbi Gogo Eslu Pefl ## 1 0 3 0 0 0 0 0 0 0 0 0 0 0 0 0 ## 2 0 5 4 3 0 0 0 0 0 0 0 0 0 0 0 ## 3 0 5 5 5 0 0 0 0 0 0 0 0 0 1 0 ## 4 0 4 5 5 0 0 0 0 0 1 0 0 1 2 2 ## 5 0 2 3 2 0 0 0 0 5 2 0 0 2 4 4 ## 6 0 3 4 5 0 0 0 0 1 2 0 0 1 1 1 ## Rham Legi Scer Cyca Titi Abbr Icme Acce Ruru Blbj Alal Anan ## 1 0 0 0 0 0 0 0 0 0 0 0 0 ## 2 0 0 0 0 0 0 0 0 0 0 0 0 ## 3 0 0 0 0 0 0 0 0 0 0 0 0 ## 4 0 0 0 0 1 0 0 0 0 0 0 0 ## 5 0 0 2 0 3 0 0 0 5 0 0 0 ## 6 0 0 0 0 2 0 0 0 1 0 0 0 spe &lt;- doubs$fish[-8,]# retiro a linha 8, pois não há dados spe.norm &lt;- decostand(spe, &quot;normalize&quot;) # função do pacote vegan, ela faz várias padronizações, aqui ele normaliza O argumento centers na função abaixo indica o número de grupos que se quer formar. Neste exemplo estamos utilizando centers=4. spe.kmeans &lt;- kmeans(spe.norm, centers=4, nstart=100) spe.kmeans ## K-means clustering with 4 clusters of sizes 12, 8, 3, 6 ## ## Cluster means: ## Cogo Satr Phph Neba Thth Teso ## 1 0.10380209 0.542300691 0.50086515 0.43325916 0.114024105 0.075651573 ## 2 0.00000000 0.006691097 0.02506109 0.06987391 0.006691097 0.006691097 ## 3 0.00000000 0.000000000 0.00000000 0.00000000 0.000000000 0.000000000 ## 4 0.06167791 0.122088022 0.26993915 0.35942538 0.032664966 0.135403325 ## Chna Chto Lele Lece Baba Spbi Gogo ## 1 0.00000000 0.00000000 0.06983991 0.1237394 0.02385019 0.0000000 0.05670453 ## 2 0.10687104 0.09377516 0.14194394 0.2011411 0.24327992 0.1326062 0.28386032 ## 3 0.05205792 0.00000000 0.07647191 0.3166705 0.00000000 0.0000000 0.20500174 ## 4 0.06212775 0.21568957 0.25887226 0.2722562 0.15647062 0.1574388 0.16822286 ## Eslu Pefl Rham Legi Scer Cyca Titi ## 1 0.04722294 0.02949244 0.0000000 0.00000000 0.00000000 0.00000000 0.03833408 ## 2 0.20630360 0.16920496 0.2214275 0.19066542 0.13171275 0.16019126 0.26230024 ## 3 0.07647191 0.00000000 0.0000000 0.05205792 0.07647191 0.00000000 0.00000000 ## 4 0.12276089 0.17261621 0.0793181 0.06190283 0.04516042 0.06190283 0.14539027 ## Abbr Icme Acce Ruru Blbj Alal Anan ## 1 0.00000000 0.0000000 0.00000000 0.01049901 0.00000000 0.0000000 0.00000000 ## 2 0.19561641 0.1331835 0.26713081 0.32103755 0.22883055 0.3326939 0.18873077 ## 3 0.00000000 0.0000000 0.18058775 0.31667052 0.05205792 0.7618709 0.00000000 ## 4 0.01473139 0.0000000 0.03192175 0.32201597 0.01473139 0.1095241 0.04739636 ## ## Clustering vector: ## 1 2 3 4 5 6 7 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 ## 1 1 1 1 4 1 1 4 1 1 1 1 1 1 4 4 4 4 2 2 2 3 3 3 2 2 ## 28 29 30 ## 2 2 2 ## ## Within cluster sum of squares by cluster: ## [1] 2.5101386 0.4696535 0.3560423 1.7361453 ## (between_SS / total_SS = 66.7 %) ## ## Available components: ## ## [1] &quot;cluster&quot; &quot;centers&quot; &quot;totss&quot; &quot;withinss&quot; &quot;tot.withinss&quot; ## [6] &quot;betweenss&quot; &quot;size&quot; &quot;iter&quot; &quot;ifault&quot; O objeto que fornece o resultado contém: 1) o tamanho (número de objetos) em cada um dos 4 grupos; 2) o centroid de cada grupo e o pertencimento de cada espécie a cada grupo; e 3) o quando da Soma de Quadrados dos dados é explicada por esta conformação de grupos. No entanto, não é possível saber a priori qual o número ideal de grupos. Para descobrir isso repetimos o k-means com uma série de valores de K. Isso pode ser feito na função cascadeKM. spe.KM.cascade &lt;- cascadeKM(spe.norm, inf.gr=2, sup.gr=10, iter=100, criterion=&quot;ssi&quot;) Tanto calinski quando ssi são bons critérios para encontrar o número ideal de grupos. Quanto maior o valor de ssi melhor (veja ?cascadeKM mais detalhes). # summary spe.KM.cascade$results ## 2 groups 3 groups 4 groups 5 groups 6 groups 7 groups 8 groups ## SSE 8.2149405 6.4768108 5.0719796 4.3015573 3.58561200 2.95236670 2.48405487 ## ssi 0.1312111 0.1675852 0.1409496 0.1123558 0.05917495 0.08003379 0.08617619 ## 9 groups 10 groups ## SSE 2.05218880 1.75992916 ## ssi 0.07322004 0.07094594 SSE: critério utilizado pelo algorítimo para achar o agrupamento ótimo dos objetos. plot(spe.KM.cascade, sortg=TRUE) Este resultado nos mostra que o número ideal de grupos é 3, vejam que o SSI máximo é alcançado neste número de grupos 0.1675852 (também indicado pela bola vermelha no plot). #Espécies indicadoras 3.3 Backgorund da análise Uma pergunta normalmente feita por ecólogos é: qual espécie pode ser indicadora de uma determinada condição ambiental? O índice IndVal mede dois aspectos das espécies: Especificidade e fidelidade. Uma alta fidelidade significa que espécies ocorrem em todos os locais do grupo e uma alta especificidade significa que as espécies ocorrem somente naquele grupo. Uma boa espécie indicadora é aquela na qual todos os indivíduos ocorrem em todas a amostras referentes a um grupo específico. A Especificidade é dada pela divisão da abundancia média da espécie no grupo pela somatória das abundancias médias dos grupos. Fidelidade é igual ao número de lugares no grupo onde a espécie está presente dividido pelo número total de lugares do grupo (Dufrêne &amp; Legendre, 1997). Espécies raras podem receber o mesmo valor de IndVal das espécies indicadoras e são chamadas de indicadoras assimétricas, i.e., contribuem com a especificidade do habitat mas não servem para predizer grupos. Ao contrário, as espécies indicadoras são verdadeiros indicadores simétricos e podem ser usadas para predizer grupos. 3.4 Exemplo 1: Pergunta: Qual espécie de anfíbio anuro na fase larval pode ser indicadora da fitofisionomia onde é encontrada? Predições 1: Espécies terrestres serão indicadoras de área aberta, enquanto espécies arborícolas serão indicadoras de áreas florestais. Variáveis Variáveis resposta Mesma matriz já utilizada contendo a abundância de girinos ao longo de poças na Serra da Bocaina. 3.4.1 Explicação da análise A análise procede da seguinte forma: Uma matriz de distância é construída e as unidades amostrais são classificadas com alguma análise de agrupamento, hierárquico ou não; A variável ambiental para a qual se deseja classificar os grupos é inserida; As espécies indicadoreas de cada grupo são formadas através do cálculo da especificidade e fidelidade, obtendo-se o valor de IndVal para cada espécie; Por fim, o conjunto de dados originais é comparado para ver se análise faz sentido. O cálculo da significância do índice de IndVal é feito por aleatorização de Monte Carlo. Assim, o valor do índice é aleatorizado 999 vezes (ou o número de vezes que você optar) dentro dos tratamentos e o valor de P é dado pelo número de vezes em que o índice observado foi igual ou maior que os valores aleatorizados. 3.4.2 Análise O IndVal está disponível tanto no pacote indicspecies quando no labdsv. Para este exemplo iremos usar o labdsv. library(labdsv) Primeiro vamos agrupar as unidades amostrais (poças) que informa os grupos de fitofisionomias onde as poças se localizam e para os quais deseja-se encontrar espécies indicadoras: fitofis &lt;- c(rep(1,4), rep(2,4), rep(3,4), rep(4,4), rep(5,4)) resultado &lt;- indval(bocaina, fitofis) summary(resultado)#só exibe o resultado para as espécies indicadoras ## cluster indicator_value probability ## Rict 1 0.8364 0.019 ## Sduar 1 0.7475 0.036 ## ## Sum of probabilities = 8.119 ## ## Sum of Indicator Values = 7.3 ## ## Sum of Significant Indicator Values = 1.58 ## ## Number of Significant Indicators = 2 ## ## Significant Indicator Distribution ## ## 1 ## 2 Para apresentar uma tabela dos resultados para todas as espécies temos de processar os dados: resultado$maxcls ## Aper Bahe Rict Cleuco Dmic Dmin Hpoly Lfur Pbar Polf ## 3 2 1 3 3 1 2 3 1 3 ## Pmelano Sduar Shay Sobt Ssqual Bokerm ## 2 1 3 2 3 2 resultado$indcls ## Aper Bahe Rict Cleuco Dmic Dmin Hpoly Lfur ## 0.2432796 0.6487329 0.8363823 0.4128631 0.6645244 0.7032145 0.6208711 0.2279412 ## Pbar Polf Pmelano Sduar Shay Sobt Ssqual Bokerm ## 0.2813725 0.2437500 0.2500000 0.7474527 0.4930269 0.2222222 0.2500000 0.4583333 resultado$pval ## Aper Bahe Rict Cleuco Dmic Dmin Hpoly Lfur Pbar Polf ## 1.000 0.057 0.019 0.407 0.229 0.085 0.267 1.000 0.607 1.000 ## Pmelano Sduar Shay Sobt Ssqual Bokerm ## 1.000 0.036 0.459 0.714 1.000 0.239 tab.resultado=cbind(resultado$maxcls,resultado$indcls,resultado$pval) colnames(tab.resultado)&lt;-c(&quot;maxgrp&quot;, &quot;ind. value&quot;,&quot;P&quot;) tab.resultado ## maxgrp ind. value P ## Aper 3 0.2432796 1.000 ## Bahe 2 0.6487329 0.057 ## Rict 1 0.8363823 0.019 ## Cleuco 3 0.4128631 0.407 ## Dmic 3 0.6645244 0.229 ## Dmin 1 0.7032145 0.085 ## Hpoly 2 0.6208711 0.267 ## Lfur 3 0.2279412 1.000 ## Pbar 1 0.2813725 0.607 ## Polf 3 0.2437500 1.000 ## Pmelano 2 0.2500000 1.000 ## Sduar 1 0.7474527 0.036 ## Shay 3 0.4930269 0.459 ## Sobt 2 0.2222222 0.714 ## Ssqual 3 0.2500000 1.000 ## Bokerm 2 0.4583333 0.239 No resultado podemos ver que temos duas espécies indicadoras da fitofisionimia 1: Rhinella icterica (Rict) e Scinax duartei (Sduar). Nenhuma espécie foi indicadora dos outros grupos neste exemplo. 3.4.3 Para se aprofundar Agrupamento de espécies e locais baseado em modelos Numerical Ecology with R "],
["rarefação.html", "Capítulo 4 Rarefação 4.1 Background da análise 4.2 Exemplo prático 1 - Morcegos 4.3 Exemplo prático 2 - Rarefação 4.4 Para se aprofundar", " Capítulo 4 Rarefação 4.1 Background da análise Uma das dificuldades na comparação da riqueza de espécies entre comunidades é decorrente da diferença no esforço amostral (e.g.diferença no número de indivíduos, discrepância na quantidade de unidades amostrais ou área amostrada) que inevitavelmente influenciará no número de espécies observadas (Gotelli &amp; Chao 2013). O método de rarefação nos permite comparar o número de espécies entre comunidades quando o tamanho da amostra ou a abundância de indivíduos não são iguais. A rarefação calcula o número esperado de espécies em cada comunidade tendo como base comparativa um valor em que todas as amostras atinjam um tamanho padrão, ou comparações baseadas na comunidade com menor número de amostragens ou com menos indivíduos. O teste foi formulado considerando seguinte pergunta: Se considerarmos n indivíduos ou amostras (n &lt; N) para cada comunidade, quantas espécies registraríamos nas comunidades considerando o mesmo número de indivíduos ou amostras? \\[E(S) = \\sum 1 - \\frac{{(N - N_1)}/{n}}{{N}/{n}}\\] Onde: E(S) = Número de espécies esperado, N = Número total de indivíduos na amostra, Ni = Número de indivíduos da iésima espécie, n = tamanho da amostra padronizada (menor amostra). Gotelli &amp; Collwel (2001) descrevem este método e discutem em detalhes as restrições sobre seu uso na ecologia: As amostras a serem comparados devem ser consistentes do ponto de vista taxonômico, ou seja, todos os indivíduos devem pertencer ao mesmo grupo taxonômico; As comparações devem ser realizadas somente entre amostras com as mesmas técnicas de coleta; Os tipos de hábitat onde as amostras são obtidas devem ser semelhantes; É um método para estimar a riqueza de espécies em uma amostra menor – não pode ser usado para extrapolar e estimar riqueza. Contudo, é importante ressaltar que esta última restrição foi superada por Colwell et al. (2012) e Chao &amp; Jost (2012) que desenvolveram uma nova abordagem onde os dados podem ser interpolados (rarefeito) para amostras menores e extrapolados para amostras maiores. 4.2 Exemplo prático 1 - Morcegos 4.2.1 Explicação Explicação dos dados Neste exemplo usaremos os dados de espécies de morcegos amostradas em três fragmentos florestais (Breviglieri 2008): i) Mata Ciliar do Córrego Talhadinho com 12 hectares inserida em uma matriz de pastagem; ii) Mata Ciliar do Córrego dos Tenentes com 10 hectares inserida em uma matriz de cultivo de cana-de-açucar e pastagem; e iii) Fazenda Experimental de Pindorama com 128 hectares inserida uma matriz de cana-de-açúcar e pastagem. Pergunta: A riqueza de espécies de morcegos é maior na Fazenda Experimental do que nos fragmentos florestais menores? Predições O número de espécies será maior em fragmentos florestais maiores. Variáveis Variáveis preditoras matriz ou dataframe com as abundâncias das espécies de morcegos registradas nos três fragmentos florestais Checklist Verificar se a sua matriz ou dataframe estão com as espécies nas linhas e os fragmentos florestais nas colunas 4.2.2 Análise Calculo da rarefação library(iNEXT) library(devtools) devtools::install_github(&quot;paternogbc/ecodados&quot;) ## checking for file ‘/tmp/RtmpYptLcD/remotes26f80502b7cb3/paternogbc-ecodados-6592f84/DESCRIPTION’ ... ✓ checking for file ‘/tmp/RtmpYptLcD/remotes26f80502b7cb3/paternogbc-ecodados-6592f84/DESCRIPTION’ ## ─ preparing ‘ecodados’: ## checking DESCRIPTION meta-information ... ✓ checking DESCRIPTION meta-information ## ─ checking for LF line-endings in source and make files and shell scripts ## ─ checking for empty or unneeded directories ## ─ building ‘ecodados_0.1.0.tar.gz’ ## ## library(ecodados) dados_rarefacao &lt;- rarefacao_morcegos resultados_morcegos &lt;- iNEXT(dados_rarefacao, q = 0, datatype = &quot;abundance&quot;, endpoint = 800) # q refere-se a família *Hill-numbers* (Hill 1973) onde 0 = riqueza de espécies, 1 = diversidade de Shannon, e 2 = diversidade de Simpson. # Veja mais detalhes sobre os números de Hill no Capítulo 7 onde tratamos de extrapolações. # datatype refere-se ao tipo de dados que você vai analisar (e.g. abudância, incidência). # endpoint refere-se ao valor de referência que você determina para a extrapolação. # Visualizar os resultados ggiNEXT(resultados_morcegos, type = 1) 4.2.3 Interpretação dos resultados Neste exemplo, foram registrados 166 indivíduos na MC_Tenentes, 413 na MC_Talhadinho e 223 na FF_Experimental. Lembrando, você não pode comparar a riqueza de espécies observada diretamente: 15 espécies na MC_Tenentes, 17 espécies na MC_Talhadinho, e 13 espécies no FF_Experimental. A comparação da riqueza de espécies entre as comunidades deve ser feita com base na riqueza de espécies estimada que é calculada com base no número de indivíduos da comunidade com menor abundância (166 indivíduos). Olhando o gráfico é possível perceber que a riqueza de espécies de morcegos estimada não é diferente entre os três fragmentos florestais quando corrigimos o problema da abundância pela rarefação. A interpretação é feita com base no intervalo de confiança de 95%. As curvas serão diferentes quando os intervalos de confiança não se sobreporem (Chao et al. 2014). Percebam que está abordagem, além da interpolação (rarefação), também realiza extrapolações que podem ser usadas para estimar o número de espécies caso o esforço de coleta fosse maior. Este é o assunto do nosso próximo capítulo.   4.3 Exemplo prático 2 - Rarefação 4.3.1 Explicação Explicação dos dados Neste exemplo iremos comparar o número de espécies de anuros e répteis (serptentes e lagartos) usando informações dos indivíduos depositados em coleções científicas e coletas de campo (da Silva et al. 2017). Pergunta: A riqueza de espécies de anuros e répteis é maior em coleções científicas do que nas coletas de campo? Predições O número de espécies será maior em coleções científicas devido ao maior esforço amostral (i.e. maior variação temporal para depositar os indíviduos e maior número de pessoas contribuindo com as informações de diferentes estudos e/ou coletas esporádicas). Variáveis Variáveis preditoras matriz ou dataframe com as abundâncias das espécies de anuros e répteis (planilhas separadas) registradas em coleções científicas e coletas de campo. Checklist Verificar se a sua matriz ou dataframe estão com as espécies nas linhas e a fonte dos dados nas colunas. 4.3.2 Análise Calculo da rarefação para os dados de répteis library(iNEXT) rarefacao_repteis &lt;- rarefacao_repteis resultados_repteis &lt;- iNEXT(rarefacao_repteis, q = 0, datatype = &quot;abundance&quot;, endpoint = 200) # Visualizar os resultados ggiNEXT(resultados_repteis, type = 1) 4.3.3 Interpretação dos resultados Neste exemplo,foram registradas oito espécies de répteis nas coletas de campo (40 indivíduos) e 28 espécies nas coleções científicas (77 indivíduos). Com base na rarefação, concluímos que a riqueza de espécies de répteis obtida nas coleções científicas é 2,5 vezes maior do que a obtida em coletas de campo.   Calculo da rarefação para os dados dos anuros library(iNEXT) rarefacao_anuros &lt;- rarefacao_anuros resultados_anuros &lt;- iNEXT(rarefacao_anuros, q = 0, datatype = &quot;abundance&quot;, endpoint = 800) # Visualizar os resultados ggiNEXT(resultados_anuros, type = 1, grey = TRUE) Interpretação dos resultados Neste exemplo,foram registradas 21 espécies de anuros nas coletas de campo (709 indivíduos) e 12 espécies nas coleções científicas (37 indivíduos). Com base na rarefação, concluímos que não há diferença entre a riqueza de espécies de anuros obtida em coletas de campo e coleções científicas.   4.4 Para se aprofundar Recomendamos aos interessados que olhem a página do EstimateS software e baixem o manual do usuário que contém informações detalhadas sobre os índices de rarefação.Este site foi criado e é mantido pelo Dr. Robert K. Colwell, um dos maiores especialistas do mundo em estimativas da biodiversidade Recomendamos também o livro Magurran &amp; McGill (2010) - Biological Diversity Frontiers in Measurement and Assessment. "],
["estimadores-de-riqueza.html", "Capítulo 5 Estimadores de Riqueza 5.1 Backgorund da análise 5.2 Estimadores baseados na abundância das espécies 5.3 Estimadores baseados na incidência das espécies", " Capítulo 5 Estimadores de Riqueza 5.1 Backgorund da análise Uma vez que determinar o número total de espécies numa área é praticamente impossível, principalmente em regiões com alta riqueza de espécies, os estimadores são úteis para extrapolar a riqueza observada e tentar estimar a riqueza total através de uma amostra incompleta de uma comunidade biológica (Walther &amp; Moore 2005). Neste capítulo serão considerados os estimadores não paramétricos que usam informações da frequencia de espécies raras na comunidade (Gotelli &amp; Chao 2013). Isto porque tanto os testes paramétricos que tentam determinar os parâmetros de uma curva usando o formato da curva de acumulação de espécies (e.g. equação logística, Michaelis-Menten) quanto os testes que usam a frequencia do número de indivíduos para enquadrá-las em uma das distribuições de abundância das espécies (e.g. distribuições log-séries, log-normal) não funcionam muito bem com dados empíricos (Gotelli &amp; Chao 2013). Para mais detalhes sobre os testes paramétricos veja Magurran (2004) e Colwell (2019). 5.1 Quatro características para um bom estimador de riqueza (Chazdon et al. 1998; Horter et al. 2006): Independência do tamanho da amostra (quantidade de esforço amostral realizado); Insensibilidade a diferentes padrões de distribuições (diferentes equitabilidades); Insensibilidade em relação à ordem das amostragens; Insensibilidade à heterogeneidade entre as amostras usadas entre estudos. 5.2 Estimadores baseados na abundância das espécies 5.2.1 CHAO 1 - (Chao 1984, 1987): Estimador simples do número absoluto de espécies em uma comunidade. É baseado no número de espécies raras dentro de uma amostra. \\[Chao_{1} = S_{obs} + \\left(\\frac{n-1}{n}\\right)\\frac{F_1(F_1-1)}{2(F_2+1)}\\] onde: Sobs = o número de espécies na comunidade, n = número de amostras, F1 = número de espécies observadas com abundância de um indivíduo (espécies singleton), F2 = número de espécies observadas com abundância de dois indivíduos (espécies doubletons). O valor de Chao 1 é máximo quando todas as espécies menos uma são únicas (singleton). Neste caso, a riqueza estimada é aproximadamente o dobro da riqueza observada.   5.2.1.1 Exemplo prático - Chao 1 5.2.1.1.1 Explicação dos dados Neste exemplo usaremos os dados de 17 espécies de anuros amostradas em 14 dias de coletas de campo em um habitat reprodutivo localizado na região noroeste do estado de São Paulo, Brasil. Pergunta: Quantas espécies a mais poderiam ser amostradas caso aumentassemos o esforço amostral? Predições O número de espécies estimadas é similar ao número de espécies observada; O número de espécies estimadas é maior do que o número de espécies observada. Variáveis Variáveis preditoras matriz ou vetor com as abundâncias das espécies de anuros registradas em um habitat reprodutivo Checklist Verificar se a sua matriz está com as espécies nas colunas e as amostragens nas linhas Verificar se os dados são de abundância e não presença e ausência 5.2.2 Análise Calculo do estimador de riqueza - Chao 1 library(ecodados) library(vegan) dados_coleta &lt;- poca_anuros est_chao1 &lt;- estaccumR(dados_coleta, permutations = 100) summary(est_chao1, display = &quot;chao&quot;) ## $chao ## N Chao 2.5% 97.5% Std.Dev ## Dia_5 1 6.536667 3.0000 11.700 2.381134 ## Dia_11 2 9.539000 6.0000 15.000 2.626646 ## Dia_7 3 10.862500 7.4750 16.525 2.274985 ## Dia_12 4 11.896667 8.0000 17.700 2.346168 ## Dia_3 5 12.490000 9.0000 17.525 2.134844 ## Dia_2 6 13.111667 10.0000 20.100 2.424483 ## Dia_6 7 13.865000 10.4750 20.100 2.288371 ## Dia_13 8 15.170000 12.0000 22.000 2.674439 ## Dia_4 9 16.170000 12.0000 22.000 2.938958 ## Dia_10 10 17.045000 13.0000 22.000 2.854285 ## Dia_14 11 17.685000 13.0000 22.000 2.658752 ## Dia_9 12 18.500000 14.2375 22.000 2.397389 ## Dia_1 13 18.980000 15.5000 22.000 1.942247 ## Dia_8 14 20.000000 20.0000 20.000 0.000000 ## ## attr(,&quot;class&quot;) ## [1] &quot;summary.poolaccum&quot; Visualizar os resultados com intervalo de confiança de 95%. library(ggplot2) # preparando os dados para fazer o gráfico resultados &lt;- summary(est_chao1, display = c(&quot;S&quot;, &quot;chao&quot;)) res_chao &lt;- cbind(resultados$chao[,1:4], resultados$S[,2:4]) res_chao &lt;- as.data.frame(res_chao) colnames(res_chao) &lt;- c(&quot;Amostras&quot;, &quot;Chao&quot;, &quot;C_inferior&quot;, &quot;C_superior&quot;, &quot;Riqueza&quot;, &quot;R_inferior&quot;, &quot;R_superior&quot;) # comando para o gráfico ggplot(res_chao, aes(y = Riqueza, x = Amostras)) + geom_point(aes(y = Chao, x = Amostras + 0.1), size = 5, color = &quot;blue&quot;, alpha = 1) + geom_point(aes(y = Riqueza, x = Amostras), size = 5, color = &quot;red&quot;, alpha = 1) + geom_line (aes(y = Chao, x = Amostras), color = &quot;blue&quot;) + geom_line (aes(y = Riqueza, x = Amostras), color = &quot;red&quot;) + geom_linerange(aes(ymin = C_inferior, ymax = C_superior, x = Amostras + 0.1), color = &quot;blue&quot;) + geom_linerange(aes(ymin = R_inferior, ymax = R_superior, x = Amostras), color = &quot;red&quot;) + ylab (&quot;Estimador de riqueza - Chao 1&quot;) + xlab (&quot;Número de amostras&quot;) + scale_x_continuous(limits = c(1,15), breaks=seq(1,15,1)) + geom_point(y= 7.5, x = 9, size = 5, color = &quot;blue&quot;, alpha = 1) + geom_point(y= 5.9, x = 9, size = 5, color = &quot;red&quot;, alpha = 1) + geom_label( y = 7.5, x = 12, label = &quot;Riqueza estimada - Chao 1&quot;) + geom_label( y = 5.9, x = 11.3, label = &quot;Riqueza observada&quot;) 5.2.2.1 Interpretação dos resultados Com base no número de espécies raras (singletons e doubletons), o estimador Chao 1 indica a possibilidade de encontrarmos mais três espécies caso o esforço amostral fosse maior e não mostra tendência de estabilização da curva em uma assíntota. 5.2.3 ACE - Abundance-based Coverage Estimador (Chao &amp; Lee 1992, Chao et al. 2000): Este método trabalha com a abundância das espécies raras (i.e. abundância baixa). Entretanto, diferente do estimador anterior, esse método permite ao pesquisador determinar os limites para os quais uma espécie seja considerada rara. Em geral, são consideradas raras espécies com abundância entre 1 e 10 indivíduos. A riqueza estimada pode variar conforme se aumente ou diminua o limiar de abundância, e infelizmente não existem critérios biológicos definidos para a escolha do melhor intervalo. \\[ACE = S_{abund} + \\frac{S_{rare}}{C_{ace}} + \\frac{F_1}{C_{ace}}Y_{ace}^2\\] onde: \\[Y_{ace}^2 = max \\left[\\frac{S_{rare}}{C_{ace}}\\frac{\\sum_{i=i}^{10}i(i-1)F1}{(N_{rare})({N_{rare} - 1)}}-1,0\\right]\\] \\[C_{ace} = 1 - \\frac{F1}{N_{rare}}\\] \\[N_{rare} = \\sum_{i=1}^{10}iF_i\\] Não precisa fazer cara feia, é óbvio que iremos usar o programa para fazer esses cálculos.   5.2.3.1 Exemplo prático - ACE 5.2.3.1.1 Explicação dos dados Usaremos os mesmos dados de 17 espécies de anuros amostradas em 14 dias de coletas de campo em um habitat reprodutivo localizado na região noroeste do estado de São Paulo, Brasil. Pergunta: Quantas espécies a mais poderiam ser amostradas caso aumentassemos o esforço amostral? Predições O número de espécies estimadas é similar ao número de espécies observada; O número de espécies estimadas é maior do que o número de espécies observada. Variáveis Variáveis preditoras matriz ou vetor com as abundâncias das espécies de anuros registradas em um habitat reprodutivo Checklist Verificar se a sua matriz está com as espécies nas colunas e as amostragens nas linhas Verificar se os dados são de abundância e não presença e ausência 5.2.4 Análise Calculo do estimador de riqueza - ACE library(vegan) dados_coleta &lt;- poca_anuros est_ace &lt;- estaccumR(dados_coleta, permutations = 100) summary(est_ace, display = &quot;ace&quot;) ## $ace ## N ACE 2.5% 97.5% Std.Dev ## Dia_13 1 7.275629 3.545190 13.71429 2.751336 ## Dia_12 2 10.054538 6.000000 16.67297 2.817916 ## Dia_3 3 11.650317 7.675156 17.57961 2.758838 ## Dia_1 4 12.550432 8.781898 18.09524 2.614171 ## Dia_7 5 13.355974 9.000000 18.57575 2.597478 ## Dia_9 6 14.382648 10.000000 20.38686 2.871141 ## Dia_2 7 15.372007 10.000000 21.08070 2.973356 ## Dia_4 8 16.216130 11.000000 22.61582 3.108951 ## Dia_8 9 17.557902 12.197607 24.60822 3.315082 ## Dia_11 10 19.181485 13.465577 25.72368 4.074365 ## Dia_14 11 20.930313 13.720826 25.72368 3.993186 ## Dia_10 12 22.559988 15.192940 25.72368 3.511785 ## Dia_6 13 24.102856 17.676471 25.72368 2.234964 ## Dia_5 14 24.703704 24.703704 24.70370 0.000000 ## ## attr(,&quot;class&quot;) ## [1] &quot;summary.poolaccum&quot; Visualizar os resultados com intervalo de confiança de 95% library(ggplot2) # preparando os dados para fazer o gráfico resultados_ace &lt;- summary(est_ace, display = c(&quot;S&quot;, &quot;ace&quot;)) res_ace &lt;- cbind(resultados_ace$ace[,1:4], resultados_ace$S[,2:4]) res_ace &lt;- as.data.frame(res_ace) colnames(res_ace) &lt;- c(&quot;Amostras&quot;, &quot;ACE&quot;, &quot;ACE_inferior&quot;, &quot;ACE_superior&quot;, &quot;Riqueza&quot;, &quot;R_inferior&quot;, &quot;R_superior&quot;) # comando para o gráfico ggplot(res_ace, aes(y = Riqueza, x = Amostras)) + geom_point(aes(y = ACE, x = Amostras + 0.1), size = 5, color = &quot;blue&quot;, alpha = 1) + geom_point(aes(y = Riqueza, x = Amostras), size = 5, color = &quot;red&quot;, alpha = 1) + geom_line (aes(y = ACE, x = Amostras), color = &quot;blue&quot;) + geom_line (aes(y = Riqueza, x = Amostras), color = &quot;red&quot;) + geom_linerange(aes(ymin = ACE_inferior, ymax = ACE_superior, x = Amostras + 0.1), color = &quot;blue&quot;) + geom_linerange(aes(ymin = R_inferior, ymax = R_superior, x = Amostras), color = &quot;red&quot;) + ylab (&quot;Estimador de riqueza - ACE&quot;) + xlab (&quot;Número de amostras&quot;) + scale_x_continuous(limits = c(1,15), breaks=seq(1,15,1)) + geom_point(y= 7.5, x = 9, size = 5, color = &quot;blue&quot;, alpha = 1) + geom_point(y= 5.9, x = 9, size = 5, color = &quot;red&quot;, alpha = 1) + geom_label( y = 7.5, x = 11.7, label = &quot;Riqueza estimada - ACE&quot;) + geom_label( y = 5.9, x = 11.3, label = &quot;Riqueza observada&quot;) 5.2.4.1 Interpretação dos resultados Com base no número de espécies raras (abundância menor que 10 indivíduos - default), o estimador ACE indica a possibilidade de encontrarmos mais sete espécies caso o esforço amostral fosse maior e não mostrou tendência de estabilição da curva em uma assíntota. 5.3 Estimadores baseados na incidência das espécies 5.3.1 CHAO 2 - (Chao 1987): De acordo com Anne Chao, o estimador Chao 1 pode ser modificado para uso com dados de presença/ausência levando em conta a distribuição das espécies entre amostras. Neste caso é necessário conhecer o número de espécies encontradas em somente uma amostra e o número de espécies encontradas exatamente em duas amostras. Essa variação ficou denominada como Chao 2: \\[Chao_{2} = S_{obs} + \\left(\\frac{m-1}{m}\\right)\\left(\\frac{Q_1(Q_1-1)}{2(Q_2 + 1}\\right)\\] onde: Sobs = o número de espécies na comunidade, m = número de amostragens, Q1 = número de espécies observadas em uma amostragem (espécies uniques), Q2 = número de espécies observadas em duas amostragens (espécies duplicates). O valor de Chao2 é máximo quando as espécies menos uma são únicas (uniques). Neste caso, a riqueza estimada é aproximadamente o dobro da riqueza observada. Colwell &amp; Coddington (1994) encontraram que o valor de Chao 2 mostrou ser o estimador menos enviesado para amostras com tamanho pequeno.   5.3.1.1 Exemplo prático - Chao 2 5.3.1.1.1 Explicação dos dados Usaremos os mesmos dados de 17 espécies de anuros amostradas em 14 dias de coletas de campo em um habitat reprodutivo localizado na região noroeste do estado de São Paulo, Brasil. Pergunta: Quantas espécies a mais poderiam ser amostradas caso aumentassemos o esforço amostral? Predições O número de espécies estimadas é similar ao número de espécies observada; O número de espécies estimadas é maior do que o número de espécies observada. Variáveis Variáveis preditoras matriz ou vetor com a incidência das espécies de anuros registradas em um habitat reprodutivo Checklist Verificar se a sua matriz está com as espécies nas colunas e as amostragens nas linhas 5.3.2 Análise Calculo do estimador de riqueza - Chao 2 library(vegan) dados_coleta &lt;- poca_anuros est_chao2 &lt;- poolaccum(dados_coleta, permutations = 100) summary(est_chao2, display = &quot;chao&quot;) ## $chao ## N Chao 2.5% 97.5% Std.Dev ## [1,] 3 13.54794 9.266667 21.00000 3.133326 ## [2,] 4 15.35737 9.075000 25.63125 4.555731 ## [3,] 5 17.16733 10.232000 29.13500 5.816714 ## [4,] 6 18.94111 10.373264 35.94167 7.154390 ## [5,] 7 20.88500 12.639286 39.57500 7.241896 ## [6,] 8 22.04245 13.058333 38.43750 6.732962 ## [7,] 9 23.47926 13.830556 38.77778 6.919071 ## [8,] 10 25.56650 13.900000 40.70375 7.121043 ## [9,] 11 27.41682 16.372727 40.94318 6.828789 ## [10,] 12 28.82625 18.666667 39.45833 5.879808 ## [11,] 13 31.31462 22.384615 39.61538 5.129360 ## [12,] 14 33.71429 33.714286 33.71429 0.000000 ## ## attr(,&quot;class&quot;) ## [1] &quot;summary.poolaccum&quot; Visualizar os resultados com intervalo de confiança de 95% library(ggplot2) # preparando os dados para fazer o gráfico resultados_chao2 &lt;- summary(est_chao2, display = c(&quot;S&quot;, &quot;chao&quot;)) res_chao2 &lt;- cbind(resultados_chao2$chao[,1:4], resultados_chao2$S[,2:4]) res_chao2 &lt;- as.data.frame(res_chao2) colnames(res_chao2) &lt;- c(&quot;Amostras&quot;, &quot;Chao2&quot;, &quot;C_inferior&quot;, &quot;C_superior&quot;, &quot;Riqueza&quot;, &quot;R_inferior&quot;, &quot;R_superior&quot;) # comando para o gráfico ggplot(res_chao2, aes(y = Riqueza, x = Amostras)) + geom_point(aes(y = Chao2, x = Amostras + 0.1), size = 5, color = &quot;blue&quot;, alpha = 1) + geom_point(aes(y = Riqueza, x = Amostras), size = 5, color = &quot;red&quot;, alpha = 1) + geom_line (aes(y = Chao2, x = Amostras), color = &quot;blue&quot;) + geom_line (aes(y = Riqueza, x = Amostras), color = &quot;red&quot;) + geom_linerange(aes(ymin = C_inferior, ymax = C_superior, x = Amostras + 0.1), color = &quot;blue&quot;) + geom_linerange(aes(ymin = R_inferior, ymax = R_superior, x = Amostras), color = &quot;red&quot;) + ylab (&quot;Estimador de riqueza - Chao 2&quot;) + xlab (&quot;Número de amostras&quot;) + scale_x_continuous(limits = c(1,15), breaks=seq(1,15,1)) + geom_point(y= 9.8, x = 10, size = 5, color = &quot;blue&quot;, alpha = 1) + geom_point(y= 7.7, x = 10, size = 5, color = &quot;red&quot;, alpha = 1) + geom_label( y = 9.8, x = 12.95, label = &quot;Riqueza estimada - Chao 2&quot;) + geom_label( y = 7.7, x = 12.3, label = &quot;Riqueza observada&quot;) 5.3.2.1 Interpretação dos resultados Com base no número de espécies raras (uniques e duplicates), Chao 2 estimou a possibilidade de encontrarmos mais dezesseis espécies caso o esforço amostral fosse maior e não mostrou tendência de estabilização da curva em uma assíntota. 5.3.3 JACKKNIFE 1 (Burnham &amp; Overton 1978, 1979): Este estimador baseia-se no número de espécies que ocorrem em somente uma amostra (Q1). \\[S_{jack1} = S_{obs} + Q1\\left(\\frac{m - 1}{m}\\right)\\] onde: Sobs = o número de espécies na comunidade, Q1 = número de espécies observadas em uma amostragem (espécies uniques), m = número de amostragens. Palmer (1990) verificou que Jackknife 1 foi o estimador mais preciso e menos enviesado comparado a outros métodos de extrapolação.   5.3.3.1 Exemplo prático - Jackknife 1 5.3.3.1.1 Explicação dos dados Usaremos os mesmos dados de 17 espécies de anuros amostradas em 14 dias de coletas de campo em um habitat reprodutivo localizado na região noroeste do estado de São Paulo, Brasil. Pergunta: Quantas espécies a mais poderiam ser amostradas caso aumentassemos o esforço amostral? Predições O número de espécies estimadas é similar ao número de espécies observada; O número de espécies estimadas é maior do que o número de espécies observada. Variáveis Variáveis preditoras matriz ou vetor com as abundâncias das espécies de anuros registradas em um habitat reprodutivo Checklist Verificar se a sua matriz está com as espécies nas colunas e as amostragens nas linhas 5.3.4 Análise Calculo do estimador de riqueza - Jackknife 1 library(vegan) dados_coleta &lt;- poca_anuros est_jack1 &lt;- poolaccum(dados_coleta, permutations = 100) summary(est_jack1, display = &quot;jack1&quot;) ## $jack1 ## N Jackknife 1 2.5% 97.5% Std.Dev ## [1,] 3 13.68667 8.491667 20.20833 3.254219 ## [2,] 4 14.63250 9.750000 20.77500 2.906900 ## [3,] 5 15.87400 11.180000 22.02000 2.863868 ## [4,] 6 16.72500 11.308333 21.83333 2.663126 ## [5,] 7 17.52286 13.121429 22.00000 2.563176 ## [6,] 8 18.42875 13.750000 23.12500 2.630151 ## [7,] 9 19.18667 14.719444 23.22222 2.437081 ## [8,] 10 20.01700 15.700000 23.30000 2.209532 ## [9,] 11 20.75000 16.727273 23.36364 2.024410 ## [10,] 12 21.30750 17.185417 23.41667 1.847804 ## [11,] 13 22.07077 18.692308 23.46154 1.297284 ## [12,] 14 22.57143 22.571429 22.57143 0.000000 ## ## attr(,&quot;class&quot;) ## [1] &quot;summary.poolaccum&quot; Visualizar os resultados com 95% intervalo de confiança library(ggplot2) # preparando os dados para fazer o gráfico resultados_jack1 &lt;- summary(est_jack1, display = c(&quot;S&quot;, &quot;jack1&quot;)) res_jack1 &lt;- cbind(resultados_jack1$jack1[,1:4], resultados_jack1$S[,2:4]) res_jack1 &lt;- as.data.frame(res_jack1) colnames(res_jack1) &lt;- c(&quot;Amostras&quot;, &quot;JACK1&quot;, &quot;JACK1_inferior&quot;, &quot;JACK1_superior&quot;, &quot;Riqueza&quot;, &quot;R_inferior&quot;, &quot;R_superior&quot;) # comando para o gráfico ggplot(res_jack1, aes(y = Riqueza, x = Amostras)) + geom_point(aes(y = JACK1, x = Amostras + 0.1), size = 5, color = &quot;blue&quot;, alpha = 1) + geom_point(aes(y = Riqueza, x = Amostras), size = 5, color = &quot;red&quot;, alpha = 1) + geom_line (aes(y = JACK1, x = Amostras), color = &quot;blue&quot;) + geom_line (aes(y = Riqueza, x = Amostras), color = &quot;red&quot;) + geom_linerange(aes(ymin = JACK1_inferior, ymax = JACK1_superior, x = Amostras + 0.1), color = &quot;blue&quot;) + geom_linerange(aes(ymin = R_inferior, ymax = R_superior, x = Amostras), color = &quot;red&quot;) + ylab (&quot;Estimador de riqueza - Jackknife 1&quot;) + xlab (&quot;Número de amostras&quot;) + scale_x_continuous(limits = c(1,15), breaks=seq(1,15,1)) + geom_point(y= 9.9, x = 9, size = 5, color = &quot;blue&quot;, alpha = 1) + geom_point(y= 8.6, x = 9, size = 5, color = &quot;red&quot;, alpha = 1) + geom_label( y = 9.9, x = 12.5, label = &quot;Riqueza estimada - Jackknife 1&quot;) + geom_label( y = 8.6, x = 11.5, label = &quot;Riqueza observada&quot;) 5.3.4.1 Interpretação dos resultados Com base no número de espécies raras, o estimador Jackknife 1 calculou a possibilidade de encontrarmos mais seis espécies caso o esforço amostral fosse maior e não mostrou tendência de estabilização da curva em uma assíntota. 5.3.5 JACKKNIFE 2 (Burnham &amp; Overton 1978, 1979, Palmer 1991): Este método basea-se no número de espécies que ocorrem em apenas uma amostra e no número de espécies que ocorrem em exatamente duas amostras. \\[S_{jack2} = S_{obs} + \\left[\\frac{Q_1(2m - 3)}{m}-\\frac{Q_2(m - 2)^2}{m(m-1)}\\right]\\] onde: Sobs = o número de espécies na comunidade, m = número de amostragens, Q1 = número de espécies observadas em uma amostragem (espécies uniques), Q2 = número de espécies observadas em duas amostragens (espécies duplicates).   5.3.5.1 Exemplo prático - Jackknife 2 5.3.5.1.1 Explicação dos dados Usaremos os mesmos dados de 17 espécies de anuros amostradas em 14 dias de coletas de campo em um habitat reprodutivo localizado na região noroeste do estado de São Paulo, Brasil. Pergunta: Quantas espécies a mais poderiam ser amostradas caso aumentassemos o esforço amostral? Predições O número de espécies estimadas é similar ao número de espécies observada; O número de espécies estimadas é maior do que o número de espécies observada. Variáveis Variáveis preditoras matriz ou vetor com as abundâncias das espécies de anuros registradas em um habitat reprodutivo Checklist Verificar se a sua matriz está com as espécies nas colunas e as amostragens nas linhas 5.3.6 Análise Calculo do estimador de riqueza - Jackknife 2 library(vegan) dados_coleta &lt;- poca_anuros est_jack2 &lt;- poolaccum(dados_coleta, permutations = 100) summary(est_jack2, display = &quot;jack2&quot;) ## $jack2 ## N Jackknife 2 2.5% 97.5% Std.Dev ## [1,] 3 14.38000 6.966667 21.16667 3.381145 ## [2,] 4 15.59083 8.725000 22.25833 3.418382 ## [3,] 5 16.96450 9.997500 24.40250 3.905877 ## [4,] 6 18.28933 10.865000 26.74583 3.937996 ## [5,] 7 19.78810 12.739881 26.80952 3.874963 ## [6,] 8 20.71446 12.941518 27.56250 4.177246 ## [7,] 9 21.56889 14.311458 29.21840 4.260633 ## [8,] 10 22.63711 14.826111 30.60000 4.109163 ## [9,] 11 23.83409 15.718182 29.64795 3.701051 ## [10,] 12 24.74705 18.492424 28.49242 3.027521 ## [11,] 13 25.88558 21.301282 28.60897 2.153069 ## [12,] 14 26.92308 26.923077 26.92308 0.000000 ## ## attr(,&quot;class&quot;) ## [1] &quot;summary.poolaccum&quot; Visualizar os resultados com intervalo de confiança de 95% library(ggplot2) # preparando os dados para fazer o gráfico resultados_jack2 &lt;- summary(est_jack2, display = c(&quot;S&quot;, &quot;jack2&quot;)) res_jack2 &lt;- cbind(resultados_jack2$jack2[,1:4], resultados_jack2$S[,2:4]) res_jack2 &lt;- as.data.frame(res_jack2) colnames(res_jack2) &lt;- c(&quot;Amostras&quot;, &quot;JACK2&quot;, &quot;JACK2_inferior&quot;, &quot;JACK2_superior&quot;, &quot;Riqueza&quot;, &quot;R_inferior&quot;, &quot;R_superior&quot;) # comando para o gráfico ggplot(res_jack2, aes(y = Riqueza, x = Amostras)) + geom_point(aes(y = JACK2, x = Amostras + 0.1), size = 5, color = &quot;blue&quot;, alpha = 1) + geom_point(aes(y = Riqueza, x = Amostras), size = 5, color = &quot;red&quot;, alpha = 1) + geom_line (aes(y = JACK2, x = Amostras), color = &quot;blue&quot;) + geom_line (aes(y = Riqueza, x = Amostras), color = &quot;red&quot;) + geom_linerange(aes(ymin = JACK2_inferior, ymax = JACK2_superior, x = Amostras + 0.1), color = &quot;blue&quot;) + geom_linerange(aes(ymin = R_inferior, ymax = R_superior, x = Amostras), color = &quot;red&quot;) + ylab (&quot;Estimador de riqueza - Jackknife 2&quot;) + xlab (&quot;Número de amostras&quot;) + scale_x_continuous(limits = c(1,15), breaks=seq(1,15,1)) + geom_point(y= 9.9, x = 9, size = 5, color = &quot;blue&quot;, alpha = 1) + geom_point(y= 8.2, x = 9, size = 5, color = &quot;red&quot;, alpha = 1) + geom_label( y = 9.9, x = 12.5, label = &quot;Riqueza estimada - Jackknife 2&quot;) + geom_label( y = 8.2, x = 11.5, label = &quot;Riqueza observada&quot;) 5.3.6.1 Interpretação dos resultados Com base no número de espécies raras, o estimador Jackknife 2 calculou a possibilidade de encontrarmos mais dez espécies caso o esforço amostral fosse maior e não mostrou tendência estabilização da curva em uma assíntota. 5.3.7 BOOTSTRAP (Smith &amp; van Belle 1984): Este método difere dos demais por utilizar dados de todas as espécies coletadas para estimar a riqueza total, não se restringindo às espécies raras. Ele requer somente dados de incidência. A estimativa pelo bootstrap é calculada somando-se a riqueza observada à soma do inverso da proporção de amostras em que cada espécie ocorre. \\[S_{boot} = S_{obs} + \\sum_{k=1}^{S_{obs}}(1-P_k)^m\\] onde: Sobs = o número de espécies na comunidade, m = número de amostragens, Pk = proporção do número de amostras em que cada espécie foi registrada.   5.3.7.1 Exemplo prático - Bootstrap 5.3.7.1.1 Explicação dos dados Usaremos os mesmos dados de 17 espécies de anuros amostradas em 14 dias de coletas de campo em um habitat reprodutivo localizado na região noroeste do estado de São Paulo, Brasil. Pergunta: Quantas espécies a mais poderiam ser amostradas caso aumentassemos o esforço amostral? Predições O número de espécies estimadas é similar ao número de espécies observada; O número de espécies estimadas é maior do que o número de espécies observada. Variáveis Variáveis preditoras matriz ou vetor com as abundâncias das espécies de anuros registradas em um habitat reprodutivo Checklist Verificar se a sua matriz está com as espécies nas colunas e as amostragens nas linhas 5.3.8 Análise Calculo do estimador de riqueza - Bootstrap library(vegan) dados_coleta &lt;- poca_anuros est_boot &lt;- poolaccum(dados_coleta, permutations = 100) summary(est_boot, display = &quot;boot&quot;) ## $boot ## N Bootstrap 2.5% 97.5% Std.Dev ## [1,] 3 12.07667 7.863889 16.48148 2.383348 ## [2,] 4 13.01504 9.636719 16.80410 2.100275 ## [3,] 5 13.92354 10.230736 17.95426 2.130706 ## [4,] 6 14.54182 11.214745 18.31980 2.026155 ## [5,] 7 15.19749 11.859688 18.88050 1.873926 ## [6,] 8 15.58819 12.765226 19.29937 1.810293 ## [7,] 9 16.16248 13.108214 19.61497 1.788253 ## [8,] 10 16.80419 13.918326 19.32206 1.690274 ## [9,] 11 17.58802 13.901678 19.57727 1.470012 ## [10,] 12 18.16177 16.020117 19.58494 1.266398 ## [11,] 13 18.55010 16.570376 19.47661 1.095733 ## [12,] 14 19.27832 19.278321 19.27832 0.000000 ## ## attr(,&quot;class&quot;) ## [1] &quot;summary.poolaccum&quot; Visualizar os resultados com intervalo de confiança de 95% library(ggplot2) # preparando os dados para fazer o gráfico resultados_boot &lt;- summary(est_boot, display = c(&quot;S&quot;, &quot;boot&quot;)) res_boot &lt;- cbind(resultados_boot$boot[,1:4], resultados_boot$S[,2:4]) res_boot &lt;- as.data.frame(res_boot) colnames(res_boot) &lt;- c(&quot;Amostras&quot;, &quot;BOOT&quot;, &quot;BOOT_inferior&quot;, &quot;BOOT_superior&quot;, &quot;Riqueza&quot;, &quot;R_inferior&quot;, &quot;R_superior&quot;) # comando para o gráfico ggplot(res_boot, aes(y = Riqueza, x = Amostras)) + geom_point(aes(y = BOOT, x = Amostras + 0.1), size = 5, color = &quot;blue&quot;, alpha = 1) + geom_point(aes(y = Riqueza, x = Amostras), size = 5, color = &quot;red&quot;, alpha = 1) + geom_line (aes(y = BOOT, x = Amostras), color = &quot;blue&quot;) + geom_line (aes(y = Riqueza, x = Amostras), color = &quot;red&quot;) + geom_linerange(aes(ymin = BOOT_inferior, ymax = BOOT_superior, x = Amostras + 0.1), color = &quot;blue&quot;) + geom_linerange(aes(ymin = R_inferior, ymax = R_superior, x = Amostras), color = &quot;red&quot;) + ylab (&quot;Estimador de riqueza - Bootstrap&quot;) + xlab (&quot;Número de amostras&quot;) + scale_x_continuous(limits = c(1,15), breaks=seq(1,15,1)) + geom_point(y= 10.4, x = 9.5, size = 5, color = &quot;blue&quot;, alpha = 1) + geom_point(y= 9.3, x = 9.5, size = 5, color = &quot;red&quot;, alpha = 1) + geom_label( y = 10.4, x = 12.3, label = &quot;Riqueza estimada - Bootstrap&quot;) + geom_label( y = 9.3, x = 11.5, label = &quot;Riqueza observada&quot;) 5.3.8.1 Interpretação dos resultados Com base na frequencia de ocorrência das espécies, o estimador bootstrap calculou a possibilidade de encontrarmos mais duas espécies caso o esforço amostral fosse maior e não mostrou tendência de estabilização da curva em uma assíntota. 5.3.9 Interpolação e Extrapolação baseadas em rarefação usando amostragens de incidência ou abundância (Chao &amp; Jost 2012, Colwell et al. 2012): Este método utiliza teoria de amostragem (e.g. modelos multinomial, Poisson e Bernoulli) para conectar rarefação (interpolação) e predição (extrapolação) com base no tamanho da amostra. Contudo, é importante enfatizar que a extrapolação torna-se altamente incerta quando extendida para o dobro do tamanho da amostragem. Este método utiliza uma abordagem com bootstrap para calcular o intervalo de confiança de 95%. Uma das vantagens desta abordagem é que ela permite além da riqueza de espécies, interpolar e extrapolar os índices de diversidade de Shannon entropy (i.e. quantifica a incerteza da identidade da espécie baseado na amostragem aleatória de um indivíduo da comunidade) e Gini-Simpson (i.e. quantifica a probabilidade que dois indivíduos escolhidos aleatoriamente sejam de diferentes espécies). Contudo, estes índices de diversidades são transformados e apresentados em unidades de riqueza de espécies (Números de Hill, Hill 1973). Hill percebeu que poderíamos calcular a riqueza de espécies máxima usando os índices de Shannon entropy e Gini-Simpson quando consideramos que todas as espécies na comunidade possuem abundâncias idênticas (máxima equitabilidade). Então, eles propos a transformação dos indíces de diversidade determinando qual seria o número de espécies equivalente da nossa comunidade (observado) se todas as espécies fossem igualmente abundantes (teórico). Desta maneira, os indíces podem ser comparavéis pois estão representados pela mesma unidade - riqueza de espécies. Os números de Hill são representados pelo parâmetro q que controla a sensibilidide do índice em relação a abudância relativa das espécies (Gotelli &amp; Chao 2013). Quando q = 0 ele não considera a abundância das espécies e é igual a riqueza de espécies. Quando q = 1 ele é o exponencial da diversidade de Shannon, que dá uma peso maior para as espécies raras. Quando q = 2 ele é a diversidade de Simpson, que dá um peso maior para as espécies mais comuns na comunidade. 5.3.9.1 Exemplo prático 5.3.9.1.1 Explicação dos dados Usaremos os mesmos dados de 17 espécies de anuros amostradas em 14 dias de coletas de campo em um habitat reprodutivo localizado na região noroeste do estado de São Paulo, Brasil. Pergunta: Quantas espécies a mais poderiam ser amostradas caso aumentassemos o esforço amostral? Predições O número de espécies estimadas é similar ao número de espécies observada; O número de espécies estimadas é maior do que o número de espécies observada. Variáveis Variáveis preditoras matriz ou vetor com as abundâncias das espécies de anuros registradas em um habitat reprodutivo Checklist Verificar se a sua matriz está com as espécies nas colunas e as amostragens nas linhas. 5.3.10 Análise Calculo da extrapolação da riqueza com base no número de indivíduos library(iNEXT) dados_coleta &lt;- poca_anuros # preparando os dados para análises considerando a abundância dados_inext_abu &lt;- colSums(dados_coleta) resultados_abundancia &lt;- iNEXT(dados_inext_abu, q = 0, datatype = &quot;abundance&quot;, endpoint = 600) # Visualizar os dados no gráfico ggiNEXT(resultados_abundancia, type = 1) 5.3.10.1 Interpretação dos resultados Veja que o ponto no final da linha contínua representa as 17 espécies de anuros (eixo Y) observadas entre os 304 individuos (eixo X). A extrapolação máxima (600 indivíduos no nosso exemplo), estima um aumento de até oito espécies (intervalo de confiança) caso amostrássemos mais 300 indivíduos. Calculo da extrapolação da riqueza com base no número de amostras library(iNEXT) dados_coleta &lt;- poca_anuros # preparando os dados para análises considerando a incidência dados_inext &lt;- as.incfreq(t(dados_coleta)) # preciso transpor o dataframe resultados_incidencia &lt;- iNEXT(dados_inext, q = 0, datatype = &quot;incidence_freq&quot;, endpoint = 30) # Visualizar os dados no gráfico ggiNEXT(resultados_incidencia, type = 1) 5.3.10.2 Interpretação dos resultados Veja que o ponto no final da linha contínua representa as 17 espécies de anuros (eixo Y) observadas nos 14 dias de coleta (eixo X - amostras). A extrapolação máxima (30 dias de coleta no nosso exemplo), estima um aumento de até 13 espécies (intervalo de confiança) caso amostrássemos mais 16 dias.   5.3.11 Para se aprofundar Recomendamos aos interessados que olhem a página do EstimateS software e baixem o manual do usuário que contém informações detalhadas sobre os índices de rarefação e estimadores de riqueza.Este site foi criado e é mantido pelo Dr. Robert K. Colwell, um dos maiores especialistas do mundo em estimativas da biodiversidade Recomendamos também o livro Magurran &amp; McGill (2010) - Biological Diversity Frontiers in Measurement and Assessment. "],
["references.html", "References", " References "]
]
