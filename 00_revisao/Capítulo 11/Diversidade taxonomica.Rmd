---

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = TRUE,
	message = FALSE,
	warning = FALSE
)
```

# Diversidade Taxon√¥mica

A diversidade biol√≥gica √© um conceito mutifacetado que pode ser definido e analisado de diferentes maneiras (e.g. diversidade gen√©tica, taxon√¥mica, funcional, filogen√©tica, ecossist√™mica, etc; vejam Magurran & McGill 2011; Gotelli & Chao 2013). Whittaker (1962) particionou a diversidade em tr√™s componentes: i) diversidade alfa (ùõÇ) que √© caracterizada pela diversidade dentro do habitat ou unidade amostral; ii) diversidade beta (ùõÉ) que √© caracterizada pela varia√ß√£o na composi√ß√£o de esp√©cies entre habitats ou unidades amostrais; e iii) diversidade gama (ùõÑ) que √© caracterizada pela combina√ß√£o da diversidade ùõÇ e ùõÉ ou definada como a diversidade regional englobando todos os habitats ou unidades amostrais. Portanto, n√£o existe um m√©todo que quantifique todos os par√¢metros associados √† diversidade biol√≥gica. Consequentemente, a escolha da m√©trica de diversidade depender√° i) do objetivo do estudo; e ii) das informa√ß√µes dispon√≠veis para o pesquisador.

Neste cap√≠tulo iremos aborda a diversidade taxon√¥mica que ignora a rela√ß√£o de parentesco entre as esp√©cies (e.g. filogenia em estrela) e as diferentes fun√ß√µes que as esp√©cies realizam no ecossistema. Na diversidade taxon√¥mica, pesquisadores est√£o interessados na riqueza de esp√©cies (e.g. n√∫mero de esp√©cies), na distribui√ß√£o de abund√¢ncia das esp√©cies (e.g. fato que algumas esp√©cies s√£o comuns e outras raras) e/ou diversidade de esp√©cies (e.g. √≠ndices que descrevem a rela√ß√£o entre a riqueza e a distribui√ß√£o da abund√¢ncia relativa das esp√©cies) nas localidades.

## Diversidade alfa (ùõÇ)

## Riqueza de esp√©cies ou n√∫mero de esp√©cies

Riqueza de esp√©cies √© uma m√©trica intuitiva e de f√°cil compreens√£o uma vez que se refere ao n√∫mero de esp√©cies observadas em uma localidade. √â importante ter em mente que os valores de riqueza de esp√©cies s√£o influ√™nciados pelo esfor√ßo amostral e sua estimativa real √© um imenso desafio (Magurran & MacGill 2011) . Compara√ß√µes entre comunidades com diferen√ßas no n√∫mero de amostragens ou abud√¢ncia das esp√©cies devem ser realizadas por meio de rarefa√ß√µes (veja cap√≠tulo 6) enquanto que o n√∫mero de esp√©cies n√£o detectadas pode ser estimado pelos estimadores de riqueza (veja cap√≠tulo 11). Embora raramente usados, como alternativa a rarefa√ß√£o, existem alguns √≠ndices que calculam a riqueza de esp√©cies considerando a abund√¢ncia total (i.e. tamanho da amostra) dentro de cada comunidade. Esses √≠ndices s√£o:

> **√çndice de Margalef**
>
> $$D_{Mg} = \frac{S-1}{ln (N)}$$
>
> onde:
>
> -   S = o n√∫mero de esp√©cies na comunidade,
>
> -   ln = logar√≠timo natural,
>
> -   N = n√∫mero total de indiv√≠duos na comunidade.

e

> **√çndice de Menhinick**
>
> $$D_{Mn} = \frac{S}{\sqrt{N}}$$
>
> onde:
>
> -   S = o n√∫mero de esp√©cies na comunidade,
>
> -   N = n√∫mero total de indiv√≠duos na comunidade.

#### Exemplo pr√°tico 1 - Riqueza de esp√©cies

**Explica√ß√£o dos dados**

Neste exemplo avaliaremos a riqueza de esp√©cies de 10 comunidades. Os dados de ocorr√™ncia das esp√©cies nas comunidades foram simulados para demonstrar as propriedades das m√©tricas de diversidade taxon√¥micas. Utilizaremos este conjunto de dados para todos os exemplos deste cap√≠tulo.

**Pergunta:**

> A distribui√ß√£o dos valores de riqueza de esp√©cies das comunidades est√° associado com o gradiente de precipita√ß√£o?

**Predi√ß√µes**

> Os valores de riqueza de esp√©cies ser√£o maiores nas comunidades localizadas em regi√µes com altas precipita√ß√µes do que em regi√µes mais secas.

**Vari√°veis**

-   Vari√°veis preditoras

    -   Dataframe com as comunidades (unidade amostral) nas linhas e as esp√©cies nas colunas.
    -   Dataframe com as comunidades (unidade amostral) nas linhas e a vari√°vel precipita√ß√£o anual na coluna

**Checklist**

-   Verificar se os dataframes de composi√ß√£o de esp√©cies e vari√°veis ambientais est√£o com as unidades amostrais nas linhas e vari√°veis preditores nas colunas

-   Verificar se as comunidades nos dataframes de composi√ß√£o de esp√©cies e vari√°veis ambientais est√£o distru√≠dos na mesma sequencia/ordem nos dois arquivos.

Abaixo demonstramos os comandos no R para determinar a riqueza de esp√©cies para cada comunidade a partir da planilha de composi√ß√£o de esp√©cies.

```{r}
# Carregando o dataframe com a composi√ß√£o de esp√©cies.  
library(ecodados)
composicao_especies <- composicao_anuros_div_taxonomica
head(composicao_especies)

# Calculando a riqueza de esp√©cies para cada comunidade
library (vegan)
(riqueza_sp <- specnumber(composicao_especies))

# Calculando √≠ndice de Margalef para cada comunidade. Primeiro, calculamos a abud√¢ncia total para cada comunidade. Em seguida, aplicamos a f√≥rmula para o c√°lculo do √≠ndice de Margalef
abundancia <- apply(composicao_especies, 1, sum)
(Margalef <- round((riqueza_sp-1)/log(abundancia), 2))

# Calculando √≠ndice de Menhinick para cada comunidade
(Menhinick <- round(riqueza_sp/sqrt(abundancia), 2))

# Analisar a rela√ß√£o entre a riqueza de esp√©cies e os √≠ndices de Margalef e Menhinick com a precipita√ß√£o anual. 
# Arquivo com dados de precipita√ß√£o para cada comunidade
precipitacao <- precipitacao_div_taxonomica

# Juntando todos os dados em um √∫nico dataframe
dados <- data.frame(precipitacao$prec, riqueza_sp, Margalef, Menhinick)
colnames(dados) <- c("Precipitacao", "Riqueza", "Margalef", "Menhinick")
dados

# Regress√£o simples para verificar a rela√ß√£o entre os √≠ndices de riqueza de esp√©cies e a precipita√ß√£o anual nas comunidades 
anova(lm(dados$Riqueza ~ dados$Precipitacao))
anova(lm(dados$Margalef ~ dados$Precipitacao))
anova(lm(dados$Menhinick ~ dados$Precipitacao))
```

**Interpreta√ß√£o dos resultados**

H√° uma rela√ß√£o positiva entre a riqueza de esp√©cies e a precipita√ß√£o anual, mas essa rela√ß√£o n√£o foi observada para os √≠ndices de riqueza. Vamos plotar o gr√°fico com os resultados da riqueza de esp√©cies ao longo do gradiente de precipita√ß√£o anual.

```{r}
library(ggplot2)
ggplot(data = dados, aes(x= Precipitacao, y= Riqueza)) + 
  labs(x = "Precipita√ß√£o anual (mm)", y = "Riqueza de esp√©cies", 
       size = 15) +
  geom_point(size = 15, shape = 21, fill = "gray") +
  geom_text(x = 1600, y = 9, label = "R2 = 0.46, P = 0.01", 
            color = "black", size = 7) +
  theme_bw() +
  theme(axis.title.y = element_text(size = 15), 
        axis.title.x = element_text(size = 15)) +
  theme(axis.text.y = element_text(size = 15), 
        axis.text.x = element_text(size = 15)) +
  theme(panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(), 
        panel.border = element_rect(colour = "black",
                                    fill=NA, size = 2)) +
  geom_smooth(method = lm, se = FALSE, color = "black") 
```

## Diversidade de esp√©cies

Diferente dos √≠ndices de riqueza de esp√©cies que n√£o levam em considera√ß√£o a abund√¢ncia relativa das esp√©cies (i.e. todas as esp√©cies tem o mesmo peso), os √≠ndices de diversidade avaliam al√©m da riqueza, a domin√¢ncia ou raridade das esp√©cies nas comunidades. Assim, quando comparamos duas comunidades com a mesma riqueza de esp√©cies, e uma das comunidades √© dominada por uma √∫nica esp√©cie e a outra comunidade apresenta esp√©cies com abund√¢ncias parecidas, consideramos a segunda comunidade mais diversa. Os √≠ndices de diversidade variam porque eles d√£o pesos diferentes para a riqueza e equitabilidade das esp√©cies. Assim, um determinado √≠ndice de diversidade pode indicar que uma comunidade X √© mais diversa que Y, enquanto outro √≠ndice indica o oposto (Melo 2008). Portanto, uma maneira para determinar qual √≠ndice de diversidade usar √© saber se voc√™ quer dar maior peso para riqueza ou equitabilidade das esp√©cies nas comunidades. Por fim, ressaltamos que h√° v√°rias cr√≠ticas em rela√ß√£o ao uso dos √≠ndices de diversidade que s√£o abstratos e dif√≠ceis de se interpretar (e.g. Hurlbert 1971). Por exemplo, dizer que o valor X estimado por √≠ndices de diversidade √© alto ou baixo √© irrelevante se n√£o tivermos uma base comparativa (para mais detalhes veja Melo 2008).

Os dois √≠ndices de diversidade mais usados na ecologia s√£o:

> **√çndice de Shannon-Wiener** - quantifica a incerteza associada em predizer a identidade de uma esp√©cie dado o n√∫mero de esp√©cies e a distribui√ß√£o de abund√¢ncia para cada esp√©cie. Este √≠ndice √© mais sens√≠vel a mudan√ßas nas esp√©cies raras da comunidade.
>
> $$H' = -\sum_{i=1}^{S}p_i * ln p_i$$
>
> onde:
>
> -   p~i~ = abund√¢ncia relativa de cada esp√©cie, calculada pela propor√ß√£o dos indiv√≠duos de uma esp√©cie pelo n√∫mero total dos indiv√≠duos na comunidade;
>
> -   ln = logar√≠timo natural, mas outras bases logar√≠timas podem ser utilizadas.

e

> **√çndice de Simpson** - quantifica a probabilidade de dois indiv√≠duos retirados ao acaso da comunidade pertencerem a mesma esp√©cies. Este √≠ndice √© na verdade uma medida de domin√¢ncia. Assim, como a probabilidade dos indiv√≠duos serem da mesma esp√©cie diminui com o aumento da riqueza de esp√©cies, o √≠ndice de Simpson tamb√©m diminui com a riqueza.
>
> $$D = \sum_{i=1}^{S}p_i^2$$
>
> onde:
>
> -   P~i~ = abund√¢ncia relativa de cada esp√©cie, calculada pela propor√ß√£o dos indiv√≠duos de uma esp√©cie pelo n√∫mero total dos indiv√≠duos na comunidade.
>
> -   D varia de 0 a 1 com valores pr√≥ximos de 1 indicando menor diversidade enquanto valores pr√≥ximos de 0 indicam maior diversidade. Para evitar confus√£o nas interpreta√ß√µes, normalmente o √≠ndice de Simpson √© expressado como o valor inverso (1 - D) para que os maiores valores representem maior diversidade. Neste caso, o valor inverso √© conhecido na literatura como √≠ndice Gini-Simpson. Para o √≠ndice Gini-Simpson estamos avaliando a probabilidade de dois indiv√≠duos retirados ao acaso da comunidade sejam de esp√©cies diferentes.

#### Exemplo pr√°tico 2 - Diversidade de esp√©cies

**Explica√ß√£o dos dados**

Usaremos os mesmos dados simulados do exemplo pr√°tico 1.

**Pergunta:**

> A distribui√ß√£o dos valores de diversidade de esp√©cies das comunidades est√° associado com o gradiente de precipita√ß√£o?

**Predi√ß√µes**

> Os valores de diversidade de esp√©cies ser√£o maiores nas comunidades localizadas em regi√µes com altas precipita√ß√µes do que em regi√µes mais secas.

Abaixo demonstramos os comandos no R para determinar a diversidade de esp√©cies para cada comunidade a partir da planilha de composi√ß√£o de esp√©cies.

```{r}
# Carregando o dataframe com a composi√ß√£o de esp√©cies.  
library(ecodados)
composicao_especies <- composicao_anuros_div_taxonomica
head(composicao_especies)

# Calculando a diversidade de esp√©cies para cada comunidade. A op√ß√£o index = "simpson" calcula o √≠ndice Gini-Simpson (1-D).
library (vegan)
shannon_res <- diversity(composicao_especies, 
                         index = "shannon", MARGIN = 1)
simpson_res <- diversity(composicao_especies, 
                         index = "simpson", MARGIN = 1) 
```

**Interpreta√ß√£o dos resultados**

A comunidade 1 foi a comunidade que apresentou a maior diversidade de esp√©cies enquanto a comunidade 2 foi a comunidade que apresentou a menor diversidade. Gostar√≠amos de chamar a aten√ß√£o para a import√¢ncia da distribui√ß√£o da abund√¢ncia relativa das esp√©cies dentro das comunidades. Percebam que tanto a comunidade 1 quanto a comunidade 2 abrigam o mesmo n√∫mero de esp√©cies (10 esp√©cies) e abund√¢ncia total (100 indiv√≠duos), mas o padr√£o de distribui√ß√£o da abund√¢ncia relativa entre as esp√©cies dentro das comunidades s√£o bem discrepantes. Na comunidade 1 as esp√©cies apresentam abund√¢ncias semelhantes entre elas (i.e. alta equitabilidade) enquanto que na comunidade 2 uma esp√©cie √© dominante e as outras raras (i.e. baixa equitabilidade). Essa diferen√ßa na distribui√ß√£o da abund√¢ncia relativa entre as comunidades √© um fator muito importante para os √≠ndices de diversidade. Dentro desta perspectiva, alguns √≠ndices fornecem uma estimativa sobre a equitabilidade da distribui√ß√£o da abund√¢ncia nas comunidades. Entre eles, o mais conhecido foi proposto por Pielou (1966):

> **√çndice de Equabilidade (ou Equitabilidade) de Pielou** √© uma m√©trica derivada do √≠ndice de Shannon-Wiener que descreve o padr√£o de abund√¢ncia relativa das esp√©cies na comunidade.
>
> $$J = \frac{H'}{Hmax} = \frac{H'}{ln (S)}$$
>
> onde:
>
> -   H' = √≠ndice de Shannon-Wiener
> -   H~max~ = todas as esp√©cies teriam a mesma abund√¢ncia relativa. H~max~ √© calculado aplicando o logar√≠tmo natural (ln) para a riqueza de esp√©cies (S).
> -   Se todas as esp√©cies apresentam a mesma abund√¢ncia relativa, ent√£o J = 1. Se uma esp√©cie apresenta forte domin√¢ncia, J aproxima-se de zero.

```{r}
# N√£o h√° uma fun√ß√£o no R que calcule o √≠ndice de Pielou, mas ele pode facilmente ser calculado usando os valores de diversidade de Shannon e o logar√≠timo da riqueza de esp√©cies de cada comunidade 
(Pielou <- shannon_res/log(specnumber(composicao_especies)))
```

Agora que temos uma ideia de como a riqueza de esp√©cies e a distribui√ß√£o da abund√¢ncia relativa s√£o importantes para quantificar os valores dos √≠ndices de diversidade, vamos testar se h√° rela√ß√£o entre os √≠ndices de diversidade e precipita√ß√£o anual nas comunidades.

```{r}
# Arquivo com dados de precipita√ß√£o para cada comunidade
precipitacao <- precipitacao_div_taxonomica

# Juntando todos os dados em um √∫nico dataframe
dados_div <- data.frame(precipitacao$prec, shannon_res, 
                        simpson_res, Pielou)
colnames(dados_div) <- c("Precipitacao", "Shannon", 
                         "Simpson", "Pielou")
dados_div 

# Regress√£o simples 
anova(lm(dados_div$Shannon ~ dados_div$Precipitacao))
anova(lm(dados_div$Simpson ~ dados_div$Precipitacao))
anova(lm(dados_div$Pielou ~ dados_div$Precipitacao))
```

**Interpreta√ß√£o dos resultados**

A distribui√ß√£o da diversidade de esp√©cies n√£o est√° associada com o gradiente de precipita√ß√£o anual.

## Diagramas de Whittaker ou Curva de Domin√¢ncia

Embora os √≠ndices de diversidade de esp√©cies englobem os componentes riqueza e abund√¢ncia relativa das esp√©cies nas suas estimativas, n√£o √© poss√≠vel conhecer o n√∫mero de esp√©cies ou quais s√£o as esp√©cies dominantes ou raras dentro das comunidades. Por exemplo, duas comunidades podem ter o mesmo valor de diversidade e ainda assim apresentarem diferen√ßas na riqueza e equitabilidade (Melo 2008). O diagrama de Whittaker √© um m√©todo que lida com essas quest√µes utilizando informa√ß√µes visuais do n√∫mero de esp√©cies e abund√¢ncia relativa de cada esp√©cie nas comunidades. Este m√©todo plota as esp√©cies ranqueadas no eixo X da mais abundante para a menos abundante enquanto que no eixo Y as abund√¢ncias das esp√©cies s√£o plotadas em escala logar√≠tima (log~10~). Este gr√°fico permite ao leitor reconhecer: i) a riqueza de esp√©cies observando o eixo X, ii) a equitabilidade da abund√¢ncia relativa das esp√©cies pela inclina√ß√£o da reta; e iii) quais s√£o as esp√©cies dominantes, intermedi√°rias e raras nas comunidades. A partir destas curvas, v√°rios autores propuseram modelos mat√©maticos para explicar a distribui√ß√£o de abund√¢ncia das esp√©cies gerando diferentes modelos te√≥ricos (e.g. s√©rie geom√©trica, *broken-stick*, log-series e log-normal). Cada modelo possui predi√ß√µes distintas: o modelo geom√©trico prediz distribui√ß√£o de abund√¢ncias desiguais, *broken-stick* prediz distribui√ß√£o de abund√¢ncias uniformes, enquanto log-normal e log-series s√£o intermedi√°rias com predi√ß√µes distintas sobre as propor√ß√µes de esp√©cies raras - alta em log-series, baixa em log-normal (veja McGill et al. 2007 para revis√£o).

```{r}
# Carregando o dataframe com a composi√ß√£o de esp√©cies.  
library(ecodados)
composicao_especies <- composicao_anuros_div_taxonomica
head(composicao_especies)

# Para an√°lises explorat√≥rios onde voc√™ tem interesse em visualizar o padr√£o da distribui√ß√£o relativa das esp√©cies por comunidade, a fun√ß√£o rankabundance do pacote BiodiversityR √© uma op√ß√£o interessante. 
library(BiodiversityR)
# calculo da curva para comunidade 2 e 3
rank_com2 <- rankabundance(composicao_especies[2, composicao_especies[2,] > 0])
rank_com3 <- rankabundance(composicao_especies[3, composicao_especies[3,] > 0])

# Gr√°fico com as curvas
rankabunplot(rank_com2, scale = "logabun", specnames = c(1), pch = 19)
rankabunplot(rank_com3, scale = "logabun", specnames = c(1), pch = 19, 
             xlim = c(0,10), addit = T, col = "blue")
```

**Interpreta√ß√£o dos resultados**

Percebam que olhando os eixos do gr√°fico conseguimos determinar que a comunidade 2 (c√≠rculo preto) abriga 10 esp√©cies no total (comprimento do eixo X), com a sp1 apresentando alta domin√¢ncia e as outras esp√©cies apresentado abund√¢ncias muito baixas. A comunidade 3 (c√≠rculo azul) abriga cinco esp√©cies no total, sendo que a sp4 apresenta alta domin√¢ncia, duas esp√©cies apresentam abund√¢ncias intermedi√°rias e outras duas abund√¢ncias baixas.

Caso o interesse seja avaliar qual dos modelos te√≥ricos melhor explica a distribui√ß√£o das abund√¢ncias das esp√©cies, a fun√ß√£o `radift` do pacote *vegan* √© a melhor op√ß√£o.

```{r}
# A fun√ß√£o radfit avalia cinco modelos te√≥rico para determinar qual deles melhor se ajusta melhor aos dados. Os modelos te√≥ricos avaliados na fun√ß√£o s√£o: i) Null = modelo broken-stick, ii) preemption = s√©rie geom√©trica; iii) log-normal; iv) Zipf; e v) Zipf-Mandelbrot. Voc√™ pode realizar as an√°lises separadamente para cada comunidade ou para todas as comunidades ao mesmo tempo. Vamos come√ßar avaliando separadamente a comunidade 2.
library (vegan)
curvas_dominancia_com2 <- radfit(composicao_especies[2,])
curvas_dominancia_com2
radlattice(curvas_dominancia_com2)
```

**Interpreta√ß√£o dos resultados**

Com base nos valores de AIC, o Zipf foi o melhor modelo explicando a distribui√ß√£o da abund√¢ncia relativa das esp√©cies na comunidade 2.

Agora vamos analisar todas as comunidades de uma s√≥ vez.

```{r}
curvas_dominancia_todas <- radfit(composicao_especies)
curvas_dominancia_todas
plot(curvas_dominancia_todas, log = "y")
```

**Interpreta√ß√£o dos resultados**

A comunidade 1 foi associada com o modelo log-normal, as comunidades 2 e 4 com o modelo Zipf, a comunidade 3 com o modelo s√©rie geom√©trica e as outras comunidades com o modelo nulo. Para explorar a explica√ß√£o biol√≥gica por tr√°s destes modelos veja os artigos (Wilson 1991; McGill et al. 2007; Magurran & McGill 2011). Contudo, esse link entre o modelo matem√°tico e a explica√ß√£o biol√≥gica precisa ser interpretado com cuidado porque diferentes modelos matem√°ticos podem levar ao mesmo padr√£o de distribui√ß√£o de abund√¢ncia.

## N√∫meros de Hill

Embora os √≠ndices de Shannon-Wiener e Gini-Simpson sejam amplamente usados em estudos ecol√≥gicos e de conserva√ß√£o, eles sofrem de propriedades matem√°ticas e n√£o representam diversidade propriamente dita (Jost et al. 2006). Portanto, quando o objetivo √© avaliar diversidade, os √≠ndices de Shannon-Wiener e Gini-Simpson n√£o deveriam ser utilizados na sua forma padr√£o, mas transformados em n√∫meros efetivos de esp√©cies ou diversidade verdadeira (Jost et al. 2006). O n√∫mero efetivo de esp√©cies √© o n√∫mero de esp√©cies igualmente abundantes (i.e. todas as esp√©cies com a mesma abund√¢ncia) necess√°rias para produzir o valor observado para o um determinado √≠ndice. Por exemplo, uma comunidade com √≠ndice de Shannon-Wiener estimado de 4,5 teria um n√∫mero efetivo de 90 esp√©cies igualmente abundantes. Jost et al. (2006) usam o seguinte exemplo para explicar o conceito do n√∫mero efeito de esp√©cies - uma comunidade com 16 esp√©cies igualmente abundantes √© duas vezes mais diversa do que uma comunidade com 8 esp√©cies igualmente abundantes. Neste caso, a diversidade deveria ser proporcional ao n√∫mero de esp√©cies. Contudo, quando aplicamos os √≠ndices de diversidade para estas comunidades com 16 e 8 esp√©cies (cada esp√©cie com 5 indiv√≠duos), o √≠ndice de Shannon-Wiener √© 2,772 e 2,079 respectivamente, e o √≠ndice de Gini-Simpson √© 0,937 e 0,875 respectivamente. Claramente, os valores estimados pelos √≠ndices de diversidade n√£o representam a diferen√ßa entre as comunidades porque eles carecem de uma particularidade matem√°tica conhecida como propriedade de duplica√ß√£o. O pr√≥ximo exemplo (modificado do website de Lou Jost; [http://www.loujost.com/](http://www.loujost.com/Statistics%20and%20Physics/Diversity%20and%20Similarity/EffectiveNumberOfSpecies.htm)) demostra a import√¢ncia da transforma√ß√£o dos √≠ndices de diversidade em n√∫meros efetivos de esp√©cies. Imagine que voc√™ foi contratado para avaliar a diversidade de peixes em um riacho antes e depois da instala√ß√£o de uma usina hidrel√©trica. Suponha que os valores estimado pelo √≠ndice de Gini-Simpson foi de 0,99 antes da instala√ß√£o e de 0,97 depois da instala√ß√£o. A princ√≠pio, voc√™ poderia concluir que a diversidade diminuiu somente 2% e que a instala√ß√£o da hidrel√©trica n√£o afetou a diversidade de peixes no riacho. Contudo, transformando os valores do √≠ndice de diversidade em n√∫meros efetivos, percebemos que antes da instala√ß√£o a diversidade do riacho equivale a 100 esp√©cies igualmente abundantes enquanto ap√≥s a instala√ß√£o, equivale a 33 esp√©cies igualmente abundantes. Portanto, a queda da diversidade √© 66% e n√£o 2%.

> Hill (1973) derivou uma equa√ß√£o geral para o c√°lculo do n√∫mero efetivo de esp√©cies ou diversidade verdadeira que depende apenas do valor de *q* e da abund√¢ncia relativa das esp√©cies:
>
> $$^qD = (\sum_{i=1}^{S}p_i^q)^{1/(1-q)}$$
>
> Onde:
>
> q = √© um param√™tro conhecido como ordem da diversidade e √© usado para dar peso as esp√©cies comuns ou raras. q = 0 n√£o considera a frequencia das esp√©cies e representa a riqueza de esp√©cies; q = 1 equivale a transforma√ß√£o do √≠ndice de Shannon-Wiener (i.e. exp(H')) e pesa as esp√©cies com base na propor√ß√£o das suas frequencias; q = 2 equivale a transforma√ß√£o do √≠ndice de Gini-Simpson (i.e. 1/(1-D)) e pesa as esp√©cies mais comuns. Valores de q \<1 favorecem esp√©cies raras enquanto valores de q \> 1 favorecem esp√©cies comuns.
>
> p~i~ = abund√¢ncia relativa de cada esp√©cie, calculada pela propor√ß√£o dos indiv√≠duos de uma esp√©cie pelo n√∫mero total dos indiv√≠duos na comunidade.

Vamos calcular o n√∫mero de Hill para as comunidades do nosso exemplo.

```{r}
library(hillR)
(hill_res_q_0 <- hill_taxa(composicao_especies, q  = 0))
(hill_res_q_1 <- hill_taxa(composicao_especies, q  = 1))
(hill_res_q_2 <- hill_taxa(composicao_especies, q  = 2))

res_hill <- data.frame(hill_res_q_0, hill_res_q_1, hill_res_q_2)
colnames(res_hill) <- c("q=0", "q=1", "q=2")
res_hill
```

**Interpreta√ß√£o dos resultados**

Como na comunidade 1 todas as esp√©cies s√£o igualmente abundantes, alterar os valores de q, n√£o altera o n√∫mero efetivo de esp√©cies que permanece sempre 10. Contudo, na comunidade 2 que apresenta alta domin√¢ncia de uma esp√©cie, alterar os valores de q diminui consideravelmente a estimativa de diversidade. A vantagem dos n√∫meros de Hill √© que eles s√£o de f√°cil interpreta√ß√£o e compara√ß√£o entre as comunidades. Fator ausente para os √≠ndices de diversidade. Neste ponto, espero que tenha ficado claro que mais do que a riqueza de esp√©cies, a abund√¢ncia relativa das esp√©cies (e.g. comuns ou raras) tem um papel fundamental na estimativa da diversidade de esp√©cies.

## Diversidade beta (ùõÉ)

O termo diversidade ùõÉ foi proposto por Whittker (1960) e foi definido como a raz√£o entre a diversidade ùõÑ e diversidade ùõÇ (i.e. diversidade ùõÉ multiplicativa) quantificando n√£o s√≥ a rela√ß√£o entre a diversidade regional e local, mas tamb√©m o grau de diferencia√ß√£o entre as comunidades. Para demonstrar como a diversidade ùõÉ varia entre comunidades locais dentro de uma regi√£o usaremos a explica√ß√£o do Baselga (<http://webspersoais.usc.es/persoais/andres.baselga/beta.html>). Imagine tr√™s comunidades, cada comunidade abrigando as mesmas cinco esp√©cies (i.e. diferencia√ß√£o m√≠nima). Neste caso, a m√©dia da diversidade ùõÇ = 5, a diversidade ùõÑ = 5 e a raz√£o entre elas (ùõÑ/ùõÇ) indica uma diversidade ùõÉ = 1. Isso significa que na regi√£o existe apenas uma unidade distinta de composi√ß√£o. Quando a composi√ß√£o de esp√©cies das tr√™s comunidades √© completamente diferente (i.e. diferencia√ß√£o m√°xima), temos que a m√©dia da diversidade ùõÇ = 5, a diversidade ùõÑ = 15 e a raz√£o entre elas indica uma diversidade ùõÉ = 3. Neste caso, existem tr√™s unidades distintas dentro da regi√£o. Assim, a diversidade ùõÉ multiplicativa varia de 1 at√© o n√∫mero de comunidades dentro da regi√£o. A maioria dos √≠ndices de (dis)similaridade utilizadas na ecologia (e.g. √≠ndices de Jaccard e S√∏rensen) s√£o √≠ndices que padranizam a diversidade ùõÉ e geram valores independentes do n√∫mero de comunidades. Por muito tempo, os valores de (dis)similaridade foram interpretados como sin√¥nimo de substitui√ß√£o de esp√©cies (turnover) entre comunidades. Contudo, indices de (dis)similaridade como Jaccard e S√∏rensen geram valores de (dis)similaridade para comunidades que n√£o apresentam diferen√ßas na composi√ß√£o de esp√©cies, mas apresentam diferen√ßas na riqueza de esp√©cies (i.e. comunidades aninhadas). Pensando nestes fatores, Baselga (2010, 2012) propos uma abordagem que particiona a diversidade ùõÉ total em dois componentes: o componente resultante da substitui√ß√£o de esp√©cies (turnover) e o componente resultante do aninhamento (i.e. diferen√ßa na riqueza de esp√©cies). Baselga (2013) propos a a parti√ß√£o da diversidadeùõÉpara √≠ndices de dissimilaridade que lidam com dados de abund√¢ncia.Neste caso os componentes da diversidadeùõÉs√£o chamados de varia√ß√£o balanceada na abund√¢ncia (similar ao componente substitui√ß√£o de esp√©cies) e gradiente de abund√¢ncia (similar ao componente aninhamento). Reconhecer estes componentes da diversidade ùõÉ √© importante porque eles apresentam padr√µes distintos (substitui√ß√£o de esp√©cies *vs* perda de esp√©cies) que provavelmente est√£o sendo gerados por processos ecol√≥gicos diferentes (Baselga 2010, 2012, 2013).

Muito dos √≠ndices de (dis)similaridade podem ser calculados para dados de presen√ßa e aus√™ncia ou abund√¢ncia (Legendre & Legendre 2012) e considerando compara√ß√µes par-a-par entre as comunidades ou compara√ß√£o entre m√∫ltiplas comunidades (i.e. multiple-site). Aqui, vamos demonstrar alguns exemplos de como calcular a parti√ß√£o da diversidade ùõÉ para os dados deste cap√≠tulo.

```{r}
library(betapart)

## Diversidade beta par a par entre usando dados de presen√ßa e aus√™ncia. Para isso, primeiro vamos transformar nossa planilha de abund√¢ncia em presen√ßa e aus√™ncia.
composicao_PA <- decostand(composicao_especies, method = "pa")
resultado_PA <- beta.pair(composicao_PA, index.family = "sorensen")

## A fun√ß√£o gera tr√™s listas com: i) diversidade beta total = √≠ndice de Sorensen (beta.sor), ii) componente substituicao de esp√©cies = Simpson (beta.sim), e iii) componente aninhado = Sorensen - Simpson (beta.sne). Vamos montar um data.frame com os resultados
data.frame_PA <- data.frame(round(as.numeric(resultado_PA$beta.sor), 2),
                            round(as.numeric(resultado_PA$beta.sim), 2),
                            round(as.numeric(resultado_PA$beta.sne), 2))
colnames(data.frame_PA) <- c("Sorensen", "Simpson", "Aninhamento")
head(data.frame_PA)

## Vamos calcular a dissimilaridade entre a precipita√ß√£o anual entre as comunidades usando o √≠ndice de distancia euclidiana. Vejam a ajuda da fun√ß√£o vegdist que calcula 17 √≠ndices diferentes de dissimilaridade.
prec_dis <- vegdist(precipitacao, method = "euclidian")
dados_prec <- as.numeric(prec_dis) 

## Agora vamos juntar os dois resultados
dados_dis <- data.frame(dados_prec, data.frame_PA)
head(dados_dis)

## Avaliar a rela√ß√£o entre os valores de diversidade beta e precipita√ß√£o
anova(lm(dados_dis$Sorensen ~ dados_dis$dados_prec))
anova(lm(dados_dis$Simpson ~ dados_dis$dados_prec))
anova(lm(dados_dis$Aninhamento ~ dados_dis$dados_prec))
```

**Interpreta√ß√£o dos resultados**

H√° uma rela√ß√£o positiva entre o componente aninhado da diversidade ùõÉ e a diferen√ßa na precipita√ß√£o entre as comunidades. Contudo, n√£o h√° rela√ß√£o entre a diversidade ùõÉ total (Sorensen) e o componente substitui√ß√£o de esp√©cies (Simpson)com a precipita√ß√£o. Vamos fazer um gr√°fico com o componente aninhamento da diversidade ùõÉ.

```{r}
library(ggplot2)
ggplot(data = dados_dis, aes(x= dados_prec, y= Aninhamento)) + 
  labs(x = "Diferen√ßa precipita√ß√£o anual (mm)", 
       y = "Componente aninhamento da\n diversidade beta", 
       size = 15) +
  geom_point(size = 15, shape = 21, fill = "gray") +
  geom_text(x = 600, y = 0.55, label = "R2 = 0.10, P = 0.01", 
            color = "black", size = 6) +
  theme_bw() +
  theme(axis.title.y = element_text(size = 15), 
        axis.title.x = element_text(size = 15)) +
  theme(axis.text.y = element_text(size = 15), 
        axis.text.x = element_text(size = 15)) +
  theme(panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(), 
        panel.border = element_rect(colour = "black",
                                    fill=NA, size = 2)) +
  geom_smooth(method = lm, se = FALSE, color = "black") 
```

**Interpreta√ß√£o dos resultados**

As comunidades com baixa precipita√ß√£o anual apresentam esp√©cies que s√£o um subgrupo das esp√©cies presentes nas comunidades com alta precipita√ß√£o anual.

Vamos fazer um exemplo considerando os dados de abund√¢ncia das esp√©cies.

```{r}
## A fun√ß√£o gera tr√™s listas com: i) diversidade beta total = √≠ndice de Bray-Curtis (beta.bray), ii) componente varia√ß√£o balanceada (beta.bray.bal), e iii) componente gradiente de abund√¢ncia (beta.bray.gra). 
resultado_AB <- beta.pair.abund(composicao_especies, index.family = "bray")

# Vamos montar um data.frame com os resultados
data.frame_AB <- data.frame(round(as.numeric(resultado_AB$beta.bray), 2),
                            round(as.numeric(resultado_AB$beta.bray.bal), 2),
                            round(as.numeric(resultado_AB$beta.bray.gra), 2))
colnames(data.frame_AB) <- c("Bray", "Balanceada", "Gradiente")
head(data.frame_AB)

## Agora vamos juntar os resultados com a precipita√ß√£o
dados_dis_AB <- data.frame(dados_prec, data.frame_AB)
head(dados_dis_AB)

## Avaliar a rela√ß√£o entre os valores de diversidade beta e precipita√ß√£o
anova(lm(dados_dis_AB$Bray ~ dados_dis$dados_prec))
anova(lm(dados_dis_AB$Balanceada ~ dados_dis$dados_prec))
anova(lm(dados_dis_AB$Gradiente ~ dados_dis$dados_prec))
```

**Interpreta√ß√£o dos resultados**

H√° uma rela√ß√£o positiva entre os componentes varia√ß√£o balanceada e gradiente de abund√¢ncia da diversidade ùõÉ e a diferen√ßa na precipita√ß√£o entre as comunidades. Contudo, n√£o h√° rela√ß√£o entre a diversidade ùõÉ total (Bray) com a precipita√ß√£o. Vamos fazer um gr√°fico para cada um dos componentes da diversidade ùõÉ.

```{r}
library(ggplot2)
ggplot(data = dados_dis_AB, aes(x= dados_prec, y= Balanceada)) + 
  labs(x = "Diferen√ßa precipita√ß√£o anual (mm)",
       y = "Componente varia√ß√£o balanceada\n da diversidade beta", 
       size = 15) +
  geom_point(size = 15, shape = 21, fill = "gray") +
  geom_text(x = 1200, y = 0.15, label = "R2 = 0.12, P = 0.01", 
            color = "black", size = 6) +
  theme_bw() +
  theme(axis.title.y = element_text(size = 15), 
        axis.title.x = element_text(size = 15)) +
  theme(axis.text.y = element_text(size = 15), 
        axis.text.x = element_text(size = 15)) +
  theme(panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(), 
        panel.border = element_rect(colour = "black",
                                    fill=NA, size = 2)) +
  geom_smooth(method = lm, se = FALSE, color = "black") 
```

**Interpreta√ß√£o dos resultados**

As comunidades com precita√ß√£o anual similares diferem nas esp√©cies que apresentam maiores abund√¢ncias enquanto que as comunidades com diferen√ßas nas precipita√ß√µes anuais n√£o apresentam este padr√£o.

```{r}
library(ggplot2)
ggplot(data = dados_dis_AB, aes(x= dados_prec, y= Gradiente)) + 
  labs(x = "Diferen√ßa precipita√ß√£o anual (mm)", 
       y = "Componente gradiente de abund√¢ncia\n da diversidade beta", 
       size = 15) +
  geom_point(size = 15, shape = 21, fill = "gray") +
  geom_text(x = 800, y = 0.75, label = "R2 = 0.28, P < 0.001", 
            color = "black", size = 6) +
  theme_bw() +
  theme(axis.title.y = element_text(size = 15), 
        axis.title.x = element_text(size = 15)) +
  theme(axis.text.y = element_text(size = 15), 
        axis.text.x = element_text(size = 15)) +
  theme(panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(), 
        panel.border = element_rect(colour = "black",
                                    fill=NA, size = 2)) +
  geom_smooth(method = lm, se = FALSE, color = "black") 
```

**Interpreta√ß√£o dos resultados**

As esp√©cies presentes nas comunidades pareadas apresentam abund√¢ncias menores nos locais com baixa precipita√ß√£o do que nos locais com alta precipita√ß√£o.

### Para se aprofundar

-   Recomendamos aos interessados a leitura dos artigos citados no cap√≠tulo e os livros Magurran & McGill (2011) - Biological Diversity Frontiers in Measurement and Assessment and Legendre & Legendre (2018) - Numerical Ecology.
