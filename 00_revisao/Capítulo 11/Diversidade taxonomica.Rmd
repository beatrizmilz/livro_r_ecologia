---

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = TRUE,
	message = FALSE,
	warning = FALSE
)
```

# Diversidade TaxonÃ´mica

A diversidade biolÃ³gica Ã© um conceito mutifacetado que pode ser definido e analisado de diferentes maneiras (e.g. diversidade genÃ©tica, taxonÃ´mica, funcional, filogenÃ©tica, ecossistÃªmica, etc; vejam Magurran & McGill 2011; Gotelli & Chao 2013). Whittaker (1962) particionou a diversidade em trÃªs componentes: i) diversidade alfa (ğ›‚) que Ã© caracterizada pela diversidade dentro do habitat ou unidade amostral; ii) diversidade beta (ğ›ƒ) que Ã© caracterizada pela variaÃ§Ã£o na composiÃ§Ã£o de espÃ©cies entre habitats ou unidades amostrais; e iii) diversidade gama (ğ›„) que Ã© caracterizada pela combinaÃ§Ã£o da diversidade ğ›‚ e ğ›ƒ ou definada como a diversidade regional englobando todos os habitats ou unidades amostrais. Portanto, nÃ£o existe um mÃ©todo que quantifique todos os parÃ¢metros associados Ã  diversidade biolÃ³gica. Consequentemente, a escolha da mÃ©trica de diversidade dependerÃ¡ i) do objetivo do estudo; e ii) das informaÃ§Ãµes disponÃ­veis para o pesquisador.

Neste capÃ­tulo iremos aborda a diversidade taxonÃ´mica que ignora a relaÃ§Ã£o de parentesco entre as espÃ©cies (e.g. filogenia em estrela) e as diferentes funÃ§Ãµes que as espÃ©cies realizam no ecossistema. Na diversidade taxonÃ´mica, pesquisadores estÃ£o interessados na riqueza de espÃ©cies (e.g. nÃºmero de espÃ©cies), na distribuiÃ§Ã£o de abundÃ¢ncia das espÃ©cies (e.g. fato que algumas espÃ©cies sÃ£o comuns e outras raras) e/ou diversidade de espÃ©cies (e.g. Ã­ndices que descrevem a relaÃ§Ã£o entre a riqueza e a distribuiÃ§Ã£o da abundÃ¢ncia relativa das espÃ©cies) nas localidades.

## Diversidade alfa (ğ›‚)

## Riqueza de espÃ©cies ou nÃºmero de espÃ©cies

Riqueza de espÃ©cies Ã© uma mÃ©trica intuitiva e de fÃ¡cil compreensÃ£o uma vez que se refere ao nÃºmero de espÃ©cies observadas em uma localidade. Ã‰ importante ter em mente que os valores de riqueza de espÃ©cies sÃ£o influÃªnciados pelo esforÃ§o amostral e sua estimativa real Ã© um imenso desafio (Magurran & MacGill 2011) . ComparaÃ§Ãµes entre comunidades com diferenÃ§as no nÃºmero de amostragens ou abudÃ¢ncia das espÃ©cies devem ser realizadas por meio de rarefaÃ§Ãµes (veja capÃ­tulo 6) enquanto que o nÃºmero de espÃ©cies nÃ£o detectadas pode ser estimado pelos estimadores de riqueza (veja capÃ­tulo 11). Embora raramente usados, como alternativa a rarefaÃ§Ã£o, existem alguns Ã­ndices que calculam a riqueza de espÃ©cies considerando a abundÃ¢ncia total (i.e. tamanho da amostra) dentro de cada comunidade. Esses Ã­ndices sÃ£o:

> **Ãndice de Margalef**
>
> $$D_{Mg} = \frac{S-1}{ln (N)}$$
>
> onde:
>
> -   S = o nÃºmero de espÃ©cies na comunidade,
>
> -   ln = logarÃ­timo natural,
>
> -   N = nÃºmero total de indivÃ­duos na comunidade.

e

> **Ãndice de Menhinick**
>
> $$D_{Mn} = \frac{S}{\sqrt{N}}$$
>
> onde:
>
> -   S = o nÃºmero de espÃ©cies na comunidade,
>
> -   N = nÃºmero total de indivÃ­duos na comunidade.

#### Exemplo prÃ¡tico 1 - Riqueza de espÃ©cies

**ExplicaÃ§Ã£o dos dados**

Neste exemplo avaliaremos a riqueza de espÃ©cies de 10 comunidades. Os dados de ocorrÃªncia das espÃ©cies nas comunidades foram simulados para demonstrar as propriedades das mÃ©tricas de diversidade taxonÃ´micas. Utilizaremos este conjunto de dados para todos os exemplos deste capÃ­tulo.

**Pergunta:**

> A distribuiÃ§Ã£o dos valores de riqueza de espÃ©cies das comunidades estÃ¡ associado com o gradiente de precipitaÃ§Ã£o?

**PrediÃ§Ãµes**

> Os valores de riqueza de espÃ©cies serÃ£o maiores nas comunidades localizadas em regiÃµes com altas precipitaÃ§Ãµes do que em regiÃµes mais secas.

**VariÃ¡veis**

-   VariÃ¡veis preditoras

    -   Dataframe com as comunidades (unidade amostral) nas linhas e as espÃ©cies nas colunas.
    -   Dataframe com as comunidades (unidade amostral) nas linhas e a variÃ¡vel precipitaÃ§Ã£o anual na coluna

**Checklist**

-   Verificar se os dataframes de composiÃ§Ã£o de espÃ©cies e variÃ¡veis ambientais estÃ£o com as unidades amostrais nas linhas e variÃ¡veis preditores nas colunas

-   Verificar se as comunidades nos dataframes de composiÃ§Ã£o de espÃ©cies e variÃ¡veis ambientais estÃ£o distruÃ­dos na mesma sequencia/ordem nos dois arquivos.

Abaixo demonstramos os comandos no R para determinar a riqueza de espÃ©cies para cada comunidade a partir da planilha de composiÃ§Ã£o de espÃ©cies.

```{r}
# Carregando o dataframe com a composiÃ§Ã£o de espÃ©cies.  
library(ecodados)
composicao_especies <- composicao_anuros_div_taxonomica
head(composicao_especies)

# Calculando a riqueza de espÃ©cies para cada comunidade
library (vegan)
(riqueza_sp <- specnumber(composicao_especies))

# Calculando Ã­ndice de Margalef para cada comunidade. Primeiro, calculamos a abudÃ¢ncia total para cada comunidade. Em seguida, aplicamos a fÃ³rmula para o cÃ¡lculo do Ã­ndice de Margalef
abundancia <- apply(composicao_especies, 1, sum)
(Margalef <- round((riqueza_sp-1)/log(abundancia), 2))

# Calculando Ã­ndice de Menhinick para cada comunidade
(Menhinick <- round(riqueza_sp/sqrt(abundancia), 2))

# Analisar a relaÃ§Ã£o entre a riqueza de espÃ©cies e os Ã­ndices de Margalef e Menhinick com a precipitaÃ§Ã£o anual. 
# Arquivo com dados de precipitaÃ§Ã£o para cada comunidade
precipitacao <- precipitacao_div_taxonomica

# Juntando todos os dados em um Ãºnico dataframe
dados <- data.frame(precipitacao$prec, riqueza_sp, Margalef, Menhinick)
colnames(dados) <- c("Precipitacao", "Riqueza", "Margalef", "Menhinick")
dados

# RegressÃ£o simples para verificar a relaÃ§Ã£o entre os Ã­ndices de riqueza de espÃ©cies e a precipitaÃ§Ã£o anual nas comunidades 
anova(lm(dados$Riqueza ~ dados$Precipitacao))
anova(lm(dados$Margalef ~ dados$Precipitacao))
anova(lm(dados$Menhinick ~ dados$Precipitacao))
```

**InterpretaÃ§Ã£o dos resultados**

HÃ¡ uma relaÃ§Ã£o positiva entre a riqueza de espÃ©cies e a precipitaÃ§Ã£o anual, mas essa relaÃ§Ã£o nÃ£o foi observada para os Ã­ndices de riqueza. Vamos plotar o grÃ¡fico com os resultados da riqueza de espÃ©cies ao longo do gradiente de precipitaÃ§Ã£o anual.

```{r}
library(ggplot2)
ggplot(data = dados, aes(x= Precipitacao, y= Riqueza)) + 
  labs(x = "PrecipitaÃ§Ã£o anual (mm)", y = "Riqueza de espÃ©cies", 
       size = 15) +
  geom_point(size = 15, shape = 21, fill = "gray") +
  geom_text(x = 1600, y = 9, label = "R2 = 0.46, P = 0.01", 
            color = "black", size = 7) +
  theme_bw() +
  theme(axis.title.y = element_text(size = 15), 
        axis.title.x = element_text(size = 15)) +
  theme(axis.text.y = element_text(size = 15), 
        axis.text.x = element_text(size = 15)) +
  theme(panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(), 
        panel.border = element_rect(colour = "black",
                                    fill=NA, size = 2)) +
  geom_smooth(method = lm, se = FALSE, color = "black") 
```

## Diversidade de espÃ©cies

Diferente dos Ã­ndices de riqueza de espÃ©cies que nÃ£o levam em consideraÃ§Ã£o a abundÃ¢ncia relativa das espÃ©cies (i.e. todas as espÃ©cies tem o mesmo peso), os Ã­ndices de diversidade avaliam alÃ©m da riqueza, a dominÃ¢ncia ou raridade das espÃ©cies nas comunidades. Assim, quando comparamos duas comunidades com a mesma riqueza de espÃ©cies, e uma das comunidades Ã© dominada por uma Ãºnica espÃ©cie e a outra comunidade apresenta espÃ©cies com abundÃ¢ncias parecidas, consideramos a segunda comunidade mais diversa. Os Ã­ndices de diversidade variam porque eles dÃ£o pesos diferentes para a riqueza e equitabilidade das espÃ©cies. Assim, um determinado Ã­ndice de diversidade pode indicar que uma comunidade X Ã© mais diversa que Y, enquanto outro Ã­ndice indica o oposto (Melo 2008). Portanto, uma maneira para determinar qual Ã­ndice de diversidade usar Ã© saber se vocÃª quer dar maior peso para riqueza ou equitabilidade das espÃ©cies nas comunidades. Por fim, ressaltamos que hÃ¡ vÃ¡rias crÃ­ticas em relaÃ§Ã£o ao uso dos Ã­ndices de diversidade que sÃ£o abstratos e difÃ­ceis de se interpretar (e.g. Hurlbert 1971). Por exemplo, dizer que o valor X estimado por Ã­ndices de diversidade Ã© alto ou baixo Ã© irrelevante se nÃ£o tivermos uma base comparativa (para mais detalhes veja Melo 2008).

Os dois Ã­ndices de diversidade mais usados na ecologia sÃ£o:

> **Ãndice de Shannon-Wiener** - quantifica a incerteza associada em predizer a identidade de uma espÃ©cie dado o nÃºmero de espÃ©cies e a distribuiÃ§Ã£o de abundÃ¢ncia para cada espÃ©cie. Este Ã­ndice Ã© mais sensÃ­vel a mudanÃ§as nas espÃ©cies raras da comunidade.
>
> $$H' = -\sum_{i=1}^{S}p_i * ln p_i$$
>
> onde:
>
> -   p~i~ = abundÃ¢ncia relativa de cada espÃ©cie, calculada pela proporÃ§Ã£o dos indivÃ­duos de uma espÃ©cie pelo nÃºmero total dos indivÃ­duos na comunidade;
>
> -   ln = logarÃ­timo natural, mas outras bases logarÃ­timas podem ser utilizadas.

e

> **Ãndice de Simpson** - quantifica a probabilidade de dois indivÃ­duos retirados ao acaso da comunidade pertencerem a mesma espÃ©cies. Este Ã­ndice Ã© na verdade uma medida de dominÃ¢ncia. Assim, como a probabilidade dos indivÃ­duos serem da mesma espÃ©cie diminui com o aumento da riqueza de espÃ©cies, o Ã­ndice de Simpson tambÃ©m diminui com a riqueza.
>
> $$D = \sum_{i=1}^{S}p_i^2$$
>
> onde:
>
> -   P~i~ = abundÃ¢ncia relativa de cada espÃ©cie, calculada pela proporÃ§Ã£o dos indivÃ­duos de uma espÃ©cie pelo nÃºmero total dos indivÃ­duos na comunidade.
>
> -   D varia de 0 a 1 com valores prÃ³ximos de 1 indicando menor diversidade enquanto valores prÃ³ximos de 0 indicam maior diversidade. Para evitar confusÃ£o nas interpretaÃ§Ãµes, normalmente o Ã­ndice de Simpson Ã© expressado como o valor inverso (1 - D) para que os maiores valores representem maior diversidade. Neste caso, o valor inverso Ã© conhecido na literatura como Ã­ndice Gini-Simpson. Para o Ã­ndice Gini-Simpson estamos avaliando a probabilidade de dois indivÃ­duos retirados ao acaso da comunidade sejam de espÃ©cies diferentes.

#### Exemplo prÃ¡tico 2 - Diversidade de espÃ©cies

**ExplicaÃ§Ã£o dos dados**

Usaremos os mesmos dados simulados do exemplo prÃ¡tico 1.

**Pergunta:**

> A distribuiÃ§Ã£o dos valores de diversidade de espÃ©cies das comunidades estÃ¡ associado com o gradiente de precipitaÃ§Ã£o?

**PrediÃ§Ãµes**

> Os valores de diversidade de espÃ©cies serÃ£o maiores nas comunidades localizadas em regiÃµes com altas precipitaÃ§Ãµes do que em regiÃµes mais secas.

Abaixo demonstramos os comandos no R para determinar a diversidade de espÃ©cies para cada comunidade a partir da planilha de composiÃ§Ã£o de espÃ©cies.

```{r}
# Carregando o dataframe com a composiÃ§Ã£o de espÃ©cies.  
library(ecodados)
composicao_especies <- composicao_anuros_div_taxonomica
head(composicao_especies)

# Calculando a diversidade de espÃ©cies para cada comunidade. A opÃ§Ã£o index = "simpson" calcula o Ã­ndice Gini-Simpson (1-D).
library (vegan)
shannon_res <- diversity(composicao_especies, 
                         index = "shannon", MARGIN = 1)
simpson_res <- diversity(composicao_especies, 
                         index = "simpson", MARGIN = 1) 
```

**InterpretaÃ§Ã£o dos resultados**

A comunidade 1 foi a comunidade que apresentou a maior diversidade de espÃ©cies enquanto a comunidade 2 foi a comunidade que apresentou a menor diversidade. GostarÃ­amos de chamar a atenÃ§Ã£o para a importÃ¢ncia da distribuiÃ§Ã£o da abundÃ¢ncia relativa das espÃ©cies dentro das comunidades. Percebam que tanto a comunidade 1 quanto a comunidade 2 abrigam o mesmo nÃºmero de espÃ©cies (10 espÃ©cies) e abundÃ¢ncia total (100 indivÃ­duos), mas o padrÃ£o de distribuiÃ§Ã£o da abundÃ¢ncia relativa entre as espÃ©cies dentro das comunidades sÃ£o bem discrepantes. Na comunidade 1 as espÃ©cies apresentam abundÃ¢ncias semelhantes entre elas (i.e. alta equitabilidade) enquanto que na comunidade 2 uma espÃ©cie Ã© dominante e as outras raras (i.e. baixa equitabilidade). Essa diferenÃ§a na distribuiÃ§Ã£o da abundÃ¢ncia relativa entre as comunidades Ã© um fator muito importante para os Ã­ndices de diversidade. Dentro desta perspectiva, alguns Ã­ndices fornecem uma estimativa sobre a equitabilidade da distribuiÃ§Ã£o da abundÃ¢ncia nas comunidades. Entre eles, o mais conhecido foi proposto por Pielou (1966):

> **Ãndice de Equabilidade (ou Equitabilidade) de Pielou** Ã© uma mÃ©trica derivada do Ã­ndice de Shannon-Wiener que descreve o padrÃ£o de abundÃ¢ncia relativa das espÃ©cies na comunidade.
>
> $$J = \frac{H'}{Hmax} = \frac{H'}{ln (S)}$$
>
> onde:
>
> -   H' = Ã­ndice de Shannon-Wiener
> -   H~max~ = todas as espÃ©cies teriam a mesma abundÃ¢ncia relativa. H~max~ Ã© calculado aplicando o logarÃ­tmo natural (ln) para a riqueza de espÃ©cies (S).
> -   Se todas as espÃ©cies apresentam a mesma abundÃ¢ncia relativa, entÃ£o J = 1. Se uma espÃ©cie apresenta forte dominÃ¢ncia, J aproxima-se de zero.

```{r}
# NÃ£o hÃ¡ uma funÃ§Ã£o no R que calcule o Ã­ndice de Pielou, mas ele pode facilmente ser calculado usando os valores de diversidade de Shannon e o logarÃ­timo da riqueza de espÃ©cies de cada comunidade 
(Pielou <- shannon_res/log(specnumber(composicao_especies)))
```

Agora que temos uma ideia de como a riqueza de espÃ©cies e a distribuiÃ§Ã£o da abundÃ¢ncia relativa sÃ£o importantes para quantificar os valores dos Ã­ndices de diversidade, vamos testar se hÃ¡ relaÃ§Ã£o entre os Ã­ndices de diversidade e precipitaÃ§Ã£o anual nas comunidades.

```{r}
# Arquivo com dados de precipitaÃ§Ã£o para cada comunidade
precipitacao <- precipitacao_div_taxonomica

# Juntando todos os dados em um Ãºnico dataframe
dados_div <- data.frame(precipitacao$prec, shannon_res, 
                        simpson_res, Pielou)
colnames(dados_div) <- c("Precipitacao", "Shannon", 
                         "Simpson", "Pielou")
dados_div 

# RegressÃ£o simples 
anova(lm(dados_div$Shannon ~ dados_div$Precipitacao))
anova(lm(dados_div$Simpson ~ dados_div$Precipitacao))
anova(lm(dados_div$Pielou ~ dados_div$Precipitacao))
```

**InterpretaÃ§Ã£o dos resultados**

A distribuiÃ§Ã£o da diversidade de espÃ©cies nÃ£o estÃ¡ associada com o gradiente de precipitaÃ§Ã£o anual.

## Diagramas de Whittaker ou Curva de DominÃ¢ncia

Embora os Ã­ndices de diversidade de espÃ©cies englobem os componentes riqueza e abundÃ¢ncia relativa das espÃ©cies nas suas estimativas, nÃ£o Ã© possÃ­vel conhecer o nÃºmero de espÃ©cies ou quais sÃ£o as espÃ©cies dominantes ou raras dentro das comunidades. Por exemplo, duas comunidades podem ter o mesmo valor de diversidade e ainda assim apresentarem diferenÃ§as na riqueza e equitabilidade (Melo 2008). O diagrama de Whittaker Ã© um mÃ©todo que lida com essas questÃµes utilizando informaÃ§Ãµes visuais do nÃºmero de espÃ©cies e abundÃ¢ncia relativa de cada espÃ©cie nas comunidades. Este mÃ©todo plota as espÃ©cies ranqueadas no eixo X da mais abundante para a menos abundante enquanto que no eixo Y as abundÃ¢ncias das espÃ©cies sÃ£o plotadas em escala logarÃ­tima (log~10~). Este grÃ¡fico permite ao leitor reconhecer: i) a riqueza de espÃ©cies observando o eixo X, ii) a equitabilidade da abundÃ¢ncia relativa das espÃ©cies pela inclinaÃ§Ã£o da reta; e iii) quais sÃ£o as espÃ©cies dominantes, intermediÃ¡rias e raras nas comunidades. A partir destas curvas, vÃ¡rios autores propuseram modelos matÃ©maticos para explicar a distribuiÃ§Ã£o de abundÃ¢ncia das espÃ©cies gerando diferentes modelos teÃ³ricos (e.g. sÃ©rie geomÃ©trica, *broken-stick*, log-series e log-normal). Cada modelo possui prediÃ§Ãµes distintas: o modelo geomÃ©trico prediz distribuiÃ§Ã£o de abundÃ¢ncias desiguais, *broken-stick* prediz distribuiÃ§Ã£o de abundÃ¢ncias uniformes, enquanto log-normal e log-series sÃ£o intermediÃ¡rias com prediÃ§Ãµes distintas sobre as proporÃ§Ãµes de espÃ©cies raras - alta em log-series, baixa em log-normal (veja McGill et al. 2007 para revisÃ£o).

```{r}
# Carregando o dataframe com a composiÃ§Ã£o de espÃ©cies.  
library(ecodados)
composicao_especies <- composicao_anuros_div_taxonomica
head(composicao_especies)

# Para anÃ¡lises exploratÃ³rios onde vocÃª tem interesse em visualizar o padrÃ£o da distribuiÃ§Ã£o relativa das espÃ©cies por comunidade, a funÃ§Ã£o rankabundance do pacote BiodiversityR Ã© uma opÃ§Ã£o interessante. 
library(BiodiversityR)
# calculo da curva para comunidade 2 e 3
rank_com2 <- rankabundance(composicao_especies[2, composicao_especies[2,] > 0])
rank_com3 <- rankabundance(composicao_especies[3, composicao_especies[3,] > 0])

# GrÃ¡fico com as curvas
rankabunplot(rank_com2, scale = "logabun", specnames = c(1), pch = 19)
rankabunplot(rank_com3, scale = "logabun", specnames = c(1), pch = 19, 
             xlim = c(0,10), addit = T, col = "blue")
```

**InterpretaÃ§Ã£o dos resultados**

Percebam que olhando os eixos do grÃ¡fico conseguimos determinar que a comunidade 2 (cÃ­rculo preto) abriga 10 espÃ©cies no total (comprimento do eixo X), com a sp1 apresentando alta dominÃ¢ncia e as outras espÃ©cies apresentado abundÃ¢ncias muito baixas. A comunidade 3 (cÃ­rculo azul) abriga cinco espÃ©cies no total, sendo que a sp4 apresenta alta dominÃ¢ncia, duas espÃ©cies apresentam abundÃ¢ncias intermediÃ¡rias e outras duas abundÃ¢ncias baixas.

Caso o interesse seja avaliar qual dos modelos teÃ³ricos melhor explica a distribuiÃ§Ã£o das abundÃ¢ncias das espÃ©cies, a funÃ§Ã£o `radift` do pacote *vegan* Ã© a melhor opÃ§Ã£o.

```{r}
# A funÃ§Ã£o radfit avalia cinco modelos teÃ³rico para determinar qual deles melhor se ajusta melhor aos dados. Os modelos teÃ³ricos avaliados na funÃ§Ã£o sÃ£o: i) Null = modelo broken-stick, ii) preemption = sÃ©rie geomÃ©trica; iii) log-normal; iv) Zipf; e v) Zipf-Mandelbrot. VocÃª pode realizar as anÃ¡lises separadamente para cada comunidade ou para todas as comunidades ao mesmo tempo. Vamos comeÃ§ar avaliando separadamente a comunidade 2.
library (vegan)
curvas_dominancia_com2 <- radfit(composicao_especies[2,])
curvas_dominancia_com2
radlattice(curvas_dominancia_com2)
```

**InterpretaÃ§Ã£o dos resultados**

Com base nos valores de AIC, o Zipf foi o melhor modelo explicando a distribuiÃ§Ã£o da abundÃ¢ncia relativa das espÃ©cies na comunidade 2.

Agora vamos analisar todas as comunidades de uma sÃ³ vez.

```{r}
curvas_dominancia_todas <- radfit(composicao_especies)
curvas_dominancia_todas
plot(curvas_dominancia_todas, log = "y")
```

**InterpretaÃ§Ã£o dos resultados**

A comunidade 1 foi associada com o modelo log-normal, as comunidades 2 e 4 com o modelo Zipf, a comunidade 3 com o modelo sÃ©rie geomÃ©trica e as outras comunidades com o modelo nulo. Para explorar a explicaÃ§Ã£o biolÃ³gica por trÃ¡s destes modelos veja os artigos (Wilson 1991; McGill et al. 2007; Magurran & McGill 2011). Contudo, esse link entre o modelo matemÃ¡tico e a explicaÃ§Ã£o biolÃ³gica precisa ser interpretado com cuidado porque diferentes modelos matemÃ¡ticos podem levar ao mesmo padrÃ£o de distribuiÃ§Ã£o de abundÃ¢ncia.

## NÃºmeros de Hill

Embora os Ã­ndices de Shannon-Wiener e Gini-Simpson sejam amplamente usados em estudos ecolÃ³gicos e de conservaÃ§Ã£o, eles sofrem de propriedades matemÃ¡ticas e nÃ£o representam diversidade propriamente dita (Jost et al. 2006). Portanto, quando o objetivo Ã© avaliar diversidade, os Ã­ndices de Shannon-Wiener e Gini-Simpson nÃ£o deveriam ser utilizados na sua forma padrÃ£o, mas transformados em nÃºmeros efetivos de espÃ©cies ou diversidade verdadeira (Jost et al. 2006). O nÃºmero efetivo de espÃ©cies Ã© o nÃºmero de espÃ©cies igualmente abundantes (i.e. todas as espÃ©cies com a mesma abundÃ¢ncia) necessÃ¡rias para produzir o valor observado para o um determinado Ã­ndice. Por exemplo, uma comunidade com Ã­ndice de Shannon-Wiener estimado de 4,5 teria um nÃºmero efetivo de 90 espÃ©cies igualmente abundantes. Jost et al. (2006) usam o seguinte exemplo para explicar o conceito do nÃºmero efeito de espÃ©cies - uma comunidade com 16 espÃ©cies igualmente abundantes Ã© duas vezes mais diversa do que uma comunidade com 8 espÃ©cies igualmente abundantes. Neste caso, a diversidade deveria ser proporcional ao nÃºmero de espÃ©cies. Contudo, quando aplicamos os Ã­ndices de diversidade para estas comunidades com 16 e 8 espÃ©cies (cada espÃ©cie com 5 indivÃ­duos), o Ã­ndice de Shannon-Wiener Ã© 2,772 e 2,079 respectivamente, e o Ã­ndice de Gini-Simpson Ã© 0,937 e 0,875 respectivamente. Claramente, os valores estimados pelos Ã­ndices de diversidade nÃ£o representam a diferenÃ§a entre as comunidades porque eles carecem de uma particularidade matemÃ¡tica conhecida como propriedade de duplicaÃ§Ã£o. O prÃ³ximo exemplo (modificado do website de Lou Jost; [http://www.loujost.com/](http://www.loujost.com/Statistics%20and%20Physics/Diversity%20and%20Similarity/EffectiveNumberOfSpecies.htm)) demostra a importÃ¢ncia da transformaÃ§Ã£o dos Ã­ndices de diversidade em nÃºmeros efetivos de espÃ©cies. Imagine que vocÃª foi contratado para avaliar a diversidade de peixes em um riacho antes e depois da instalaÃ§Ã£o de uma usina hidrelÃ©trica. Suponha que os valores estimado pelo Ã­ndice de Gini-Simpson foi de 0,99 antes da instalaÃ§Ã£o e de 0,97 depois da instalaÃ§Ã£o. A princÃ­pio, vocÃª poderia concluir que a diversidade diminuiu somente 2% e que a instalaÃ§Ã£o da hidrelÃ©trica nÃ£o afetou a diversidade de peixes no riacho. Contudo, transformando os valores do Ã­ndice de diversidade em nÃºmeros efetivos, percebemos que antes da instalaÃ§Ã£o a diversidade do riacho equivale a 100 espÃ©cies igualmente abundantes enquanto apÃ³s a instalaÃ§Ã£o, equivale a 33 espÃ©cies igualmente abundantes. Portanto, a queda da diversidade Ã© 66% e nÃ£o 2%.

> Hill (1973) derivou uma equaÃ§Ã£o geral para o cÃ¡lculo do nÃºmero efetivo de espÃ©cies ou diversidade verdadeira que depende apenas do valor de *q* e da abundÃ¢ncia relativa das espÃ©cies:
>
> $$^qD = (\sum_{i=1}^{S}p_i^q)^{1/(1-q)}$$
>
> Onde:
>
> q = Ã© um paramÃªtro conhecido como ordem da diversidade e Ã© usado para dar peso as espÃ©cies comuns ou raras. q = 0 nÃ£o considera a frequencia das espÃ©cies e representa a riqueza de espÃ©cies; q = 1 equivale a transformaÃ§Ã£o do Ã­ndice de Shannon-Wiener (i.e. exp(H')) e pesa as espÃ©cies com base na proporÃ§Ã£o das suas frequencias; q = 2 equivale a transformaÃ§Ã£o do Ã­ndice de Gini-Simpson (i.e. 1/(1-D)) e pesa as espÃ©cies mais comuns. Valores de q \<1 favorecem espÃ©cies raras enquanto valores de q \> 1 favorecem espÃ©cies comuns.
>
> p~i~ = abundÃ¢ncia relativa de cada espÃ©cie, calculada pela proporÃ§Ã£o dos indivÃ­duos de uma espÃ©cie pelo nÃºmero total dos indivÃ­duos na comunidade.

Vamos calcular o nÃºmero de Hill para as comunidades do nosso exemplo.

```{r}
library(hillR)
(hill_res_q_0 <- hill_taxa(composicao_especies, q  = 0))
(hill_res_q_1 <- hill_taxa(composicao_especies, q  = 1))
(hill_res_q_2 <- hill_taxa(composicao_especies, q  = 2))

res_hill <- data.frame(hill_res_q_0, hill_res_q_1, hill_res_q_2)
colnames(res_hill) <- c("q=0", "q=1", "q=2")
res_hill
```

**InterpretaÃ§Ã£o dos resultados**

Como na comunidade 1 todas as espÃ©cies sÃ£o igualmente abundantes, alterar os valores de q, nÃ£o altera o nÃºmero efetivo de espÃ©cies que permanece sempre 10. Contudo, na comunidade 2 que apresenta alta dominÃ¢ncia de uma espÃ©cie, alterar os valores de q diminui consideravelmente a estimativa de diversidade. A vantagem dos nÃºmeros de Hill Ã© que eles sÃ£o de fÃ¡cil interpretaÃ§Ã£o e comparaÃ§Ã£o entre as comunidades. Fator ausente para os Ã­ndices de diversidade. Neste ponto, espero que tenha ficado claro que mais do que a riqueza de espÃ©cies, a abundÃ¢ncia relativa das espÃ©cies (e.g. comuns ou raras) tem um papel fundamental na estimativa da diversidade de espÃ©cies.

## Diversidade beta (ğ›ƒ)

O termo diversidade ğ›ƒ foi proposto por Whittker (1960) e foi definido como a razÃ£o entre a diversidade ğ›„ e diversidade ğ›‚ (i.e. diversidade ğ›ƒ multiplicativa) quantificando nÃ£o sÃ³ a relaÃ§Ã£o entre a diversidade regional e local, mas tambÃ©m o grau de diferenciaÃ§Ã£o entre as comunidades. Para demonstrar como a diversidade ğ›ƒ varia entre comunidades locais dentro de uma regiÃ£o usaremos a explicaÃ§Ã£o do Baselga (<http://webspersoais.usc.es/persoais/andres.baselga/beta.html>). Imagine trÃªs comunidades, cada comunidade abrigando as mesmas cinco espÃ©cies (i.e. diferenciaÃ§Ã£o mÃ­nima). Neste caso, a mÃ©dia da diversidade ğ›‚ = 5, a diversidade ğ›„ = 5 e a razÃ£o entre elas (ğ›„/ğ›‚) indica uma diversidade ğ›ƒ = 1. Isso significa que na regiÃ£o existe apenas uma unidade distinta de composiÃ§Ã£o. Quando a composiÃ§Ã£o de espÃ©cies das trÃªs comunidades Ã© completamente diferente (i.e. diferenciaÃ§Ã£o mÃ¡xima), temos que a mÃ©dia da diversidade ğ›‚ = 5, a diversidade ğ›„ = 15 e a razÃ£o entre elas indica uma diversidade ğ›ƒ = 3. Neste caso, existem trÃªs unidades distintas dentro da regiÃ£o. Assim, a diversidade ğ›ƒ multiplicativa varia de 1 atÃ© o nÃºmero de comunidades dentro da regiÃ£o. A maioria dos Ã­ndices de (dis)similaridade utilizadas na ecologia (e.g. Ã­ndices de Jaccard e SÃ¸rensen) sÃ£o Ã­ndices que padranizam a diversidade ğ›ƒ e geram valores independentes do nÃºmero de comunidades. Por muito tempo, os valores de (dis)similaridade foram interpretados como sinÃ´nimo de substituiÃ§Ã£o de espÃ©cies (turnover) entre comunidades. Contudo, indices de (dis)similaridade como Jaccard e SÃ¸rensen geram valores de (dis)similaridade para comunidades que nÃ£o apresentam diferenÃ§as na composiÃ§Ã£o de espÃ©cies, mas apresentam diferenÃ§as na riqueza de espÃ©cies (i.e. comunidades aninhadas). Pensando nestes fatores, Baselga (2010, 2012) propos uma abordagem que particiona a diversidade ğ›ƒ total em dois componentes: o componente resultante da substituiÃ§Ã£o de espÃ©cies (turnover) e o componente resultante do aninhamento (i.e. diferenÃ§a na riqueza de espÃ©cies). Baselga (2013) propos a a partiÃ§Ã£o da diversidadeğ›ƒpara Ã­ndices de dissimilaridade que lidam com dados de abundÃ¢ncia.Neste caso os componentes da diversidadeğ›ƒsÃ£o chamados de variaÃ§Ã£o balanceada na abundÃ¢ncia (similar ao componente substituiÃ§Ã£o de espÃ©cies) e gradiente de abundÃ¢ncia (similar ao componente aninhamento). Reconhecer estes componentes da diversidade ğ›ƒ Ã© importante porque eles apresentam padrÃµes distintos (substituiÃ§Ã£o de espÃ©cies *vs* perda de espÃ©cies) que provavelmente estÃ£o sendo gerados por processos ecolÃ³gicos diferentes (Baselga 2010, 2012, 2013).

Muito dos Ã­ndices de (dis)similaridade podem ser calculados para dados de presenÃ§a e ausÃªncia ou abundÃ¢ncia (Legendre & Legendre 2012) e considerando comparaÃ§Ãµes par-a-par entre as comunidades ou comparaÃ§Ã£o entre mÃºltiplas comunidades (i.e. multiple-site). Aqui, vamos demonstrar alguns exemplos de como calcular a partiÃ§Ã£o da diversidade ğ›ƒ para os dados deste capÃ­tulo.

```{r}
library(betapart)

## Diversidade beta par a par entre usando dados de presenÃ§a e ausÃªncia. Para isso, primeiro vamos transformar nossa planilha de abundÃ¢ncia em presenÃ§a e ausÃªncia.
composicao_PA <- decostand(composicao_especies, method = "pa")
resultado_PA <- beta.pair(composicao_PA, index.family = "sorensen")

## A funÃ§Ã£o gera trÃªs listas com: i) diversidade beta total = Ã­ndice de Sorensen (beta.sor), ii) componente substituicao de espÃ©cies = Simpson (beta.sim), e iii) componente aninhado = Sorensen - Simpson (beta.sne). Vamos montar um data.frame com os resultados
data.frame_PA <- data.frame(round(as.numeric(resultado_PA$beta.sor), 2),
                            round(as.numeric(resultado_PA$beta.sim), 2),
                            round(as.numeric(resultado_PA$beta.sne), 2))
colnames(data.frame_PA) <- c("Sorensen", "Simpson", "Aninhamento")
head(data.frame_PA)

## Vamos calcular a dissimilaridade entre a precipitaÃ§Ã£o anual entre as comunidades usando o Ã­ndice de distancia euclidiana. Vejam a ajuda da funÃ§Ã£o vegdist que calcula 17 Ã­ndices diferentes de dissimilaridade.
prec_dis <- vegdist(precipitacao, method = "euclidian")
dados_prec <- as.numeric(prec_dis) 

## Agora vamos juntar os dois resultados
dados_dis <- data.frame(dados_prec, data.frame_PA)
head(dados_dis)

## Avaliar a relaÃ§Ã£o entre os valores de diversidade beta e precipitaÃ§Ã£o
anova(lm(dados_dis$Sorensen ~ dados_dis$dados_prec))
anova(lm(dados_dis$Simpson ~ dados_dis$dados_prec))
anova(lm(dados_dis$Aninhamento ~ dados_dis$dados_prec))
```

**InterpretaÃ§Ã£o dos resultados**

HÃ¡ uma relaÃ§Ã£o positiva entre o componente aninhado da diversidade ğ›ƒ e a diferenÃ§a na precipitaÃ§Ã£o entre as comunidades. Contudo, nÃ£o hÃ¡ relaÃ§Ã£o entre a diversidade ğ›ƒ total (Sorensen) e o componente substituiÃ§Ã£o de espÃ©cies (Simpson)com a precipitaÃ§Ã£o. Vamos fazer um grÃ¡fico com o componente aninhamento da diversidade ğ›ƒ.

```{r}
library(ggplot2)
ggplot(data = dados_dis, aes(x= dados_prec, y= Aninhamento)) + 
  labs(x = "DiferenÃ§a precipitaÃ§Ã£o anual (mm)", 
       y = "Componente aninhamento da\n diversidade beta", 
       size = 15) +
  geom_point(size = 15, shape = 21, fill = "gray") +
  geom_text(x = 600, y = 0.55, label = "R2 = 0.10, P = 0.01", 
            color = "black", size = 6) +
  theme_bw() +
  theme(axis.title.y = element_text(size = 15), 
        axis.title.x = element_text(size = 15)) +
  theme(axis.text.y = element_text(size = 15), 
        axis.text.x = element_text(size = 15)) +
  theme(panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(), 
        panel.border = element_rect(colour = "black",
                                    fill=NA, size = 2)) +
  geom_smooth(method = lm, se = FALSE, color = "black") 
```

**InterpretaÃ§Ã£o dos resultados**

As comunidades com baixa precipitaÃ§Ã£o anual apresentam espÃ©cies que sÃ£o um subgrupo das espÃ©cies presentes nas comunidades com alta precipitaÃ§Ã£o anual.

Vamos fazer um exemplo considerando os dados de abundÃ¢ncia das espÃ©cies.

```{r}
## A funÃ§Ã£o gera trÃªs listas com: i) diversidade beta total = Ã­ndice de Bray-Curtis (beta.bray), ii) componente variaÃ§Ã£o balanceada (beta.bray.bal), e iii) componente gradiente de abundÃ¢ncia (beta.bray.gra). 
resultado_AB <- beta.pair.abund(composicao_especies, index.family = "bray")

# Vamos montar um data.frame com os resultados
data.frame_AB <- data.frame(round(as.numeric(resultado_AB$beta.bray), 2),
                            round(as.numeric(resultado_AB$beta.bray.bal), 2),
                            round(as.numeric(resultado_AB$beta.bray.gra), 2))
colnames(data.frame_AB) <- c("Bray", "Balanceada", "Gradiente")
head(data.frame_AB)

## Agora vamos juntar os resultados com a precipitaÃ§Ã£o
dados_dis_AB <- data.frame(dados_prec, data.frame_AB)
head(dados_dis_AB)

## Avaliar a relaÃ§Ã£o entre os valores de diversidade beta e precipitaÃ§Ã£o
anova(lm(dados_dis_AB$Bray ~ dados_dis$dados_prec))
anova(lm(dados_dis_AB$Balanceada ~ dados_dis$dados_prec))
anova(lm(dados_dis_AB$Gradiente ~ dados_dis$dados_prec))
```

**InterpretaÃ§Ã£o dos resultados**

HÃ¡ uma relaÃ§Ã£o positiva entre os componentes variaÃ§Ã£o balanceada e gradiente de abundÃ¢ncia da diversidade ğ›ƒ e a diferenÃ§a na precipitaÃ§Ã£o entre as comunidades. Contudo, nÃ£o hÃ¡ relaÃ§Ã£o entre a diversidade ğ›ƒ total (Bray) com a precipitaÃ§Ã£o. Vamos fazer um grÃ¡fico para cada um dos componentes da diversidade ğ›ƒ.

```{r}
library(ggplot2)
ggplot(data = dados_dis_AB, aes(x= dados_prec, y= Balanceada)) + 
  labs(x = "DiferenÃ§a precipitaÃ§Ã£o anual (mm)",
       y = "Componente variaÃ§Ã£o balanceada\n da diversidade beta", 
       size = 15) +
  geom_point(size = 15, shape = 21, fill = "gray") +
  geom_text(x = 1200, y = 0.15, label = "R2 = 0.12, P = 0.01", 
            color = "black", size = 6) +
  theme_bw() +
  theme(axis.title.y = element_text(size = 15), 
        axis.title.x = element_text(size = 15)) +
  theme(axis.text.y = element_text(size = 15), 
        axis.text.x = element_text(size = 15)) +
  theme(panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(), 
        panel.border = element_rect(colour = "black",
                                    fill=NA, size = 2)) +
  geom_smooth(method = lm, se = FALSE, color = "black") 
```

**InterpretaÃ§Ã£o dos resultados**

As comunidades com precitaÃ§Ã£o anual similares diferem nas espÃ©cies que apresentam maiores abundÃ¢ncias enquanto que as comunidades com diferenÃ§as nas precipitaÃ§Ãµes anuais nÃ£o apresentam este padrÃ£o.

```{r}
library(ggplot2)
ggplot(data = dados_dis_AB, aes(x= dados_prec, y= Gradiente)) + 
  labs(x = "DiferenÃ§a precipitaÃ§Ã£o anual (mm)", 
       y = "Componente gradiente de abundÃ¢ncia\n da diversidade beta", 
       size = 15) +
  geom_point(size = 15, shape = 21, fill = "gray") +
  geom_text(x = 800, y = 0.75, label = "R2 = 0.28, P < 0.001", 
            color = "black", size = 6) +
  theme_bw() +
  theme(axis.title.y = element_text(size = 15), 
        axis.title.x = element_text(size = 15)) +
  theme(axis.text.y = element_text(size = 15), 
        axis.text.x = element_text(size = 15)) +
  theme(panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(), 
        panel.border = element_rect(colour = "black",
                                    fill=NA, size = 2)) +
  geom_smooth(method = lm, se = FALSE, color = "black") 
```

**InterpretaÃ§Ã£o dos resultados**

As espÃ©cies presentes nas comunidades pareadas apresentam abundÃ¢ncias menores nos locais com baixa precipitaÃ§Ã£o do que nos locais com alta precipitaÃ§Ã£o.

### Para se aprofundar

-   Recomendamos aos interessados a leitura dos artigos citados no capÃ­tulo e os livros Magurran & McGill (2011) - Biological Diversity Frontiers in Measurement and Assessment and Legendre & Legendre (2018) - Numerical Ecology.
